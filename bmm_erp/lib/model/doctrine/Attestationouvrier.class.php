<?php

/**
 * Attestationouvrier
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    PhpProjectTest
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Attestationouvrier extends BaseAttestationouvrier {

    public function ReadHtmlAttestationdetaravil() {

        $html = '<div class="titre" style="text-align:center;font-size:22px;width:100%;">'
                . ' بطــــاقة تشغيل' .
                '</div>&nbsp;<br>&nbsp;<br>';

        $html.='<table>
                <tr><td style="width:160px;text-align:right;font-size:14px;">قبلي، في : ' . date('d/m/Y') . '</td></tr>
                </table>&nbsp;<br>&nbsp;<br>&nbsp;<br>';

        $html.='<table style="text-align:right;width:100%">
                    <tr>
                        <td style="width:90%; height:30px;">' . str_pad($this->getChantier()->getLibelle(), 350, '.', STR_PAD_RIGHT) . '</td>
                        <td style="width:10%">الحظيرة</td>
                    </tr>
                    <tr>
                        <td style="width:43%; height:30px;">' . str_pad($this->getDirection()->getLibelle(), 270, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:7%">الإدارة</td>
                        <td style="width:40%"> ' . str_pad($this->getServicerh()->getLibelle(), 260, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:10%">المصلحة</td>
                    </tr>
                    <tr>
                        <td style="width:43%; height:30px;">' . str_pad($this->getPorte(), 300, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:7%">الباب</td>
                        <td style="width:40%"> ' . str_pad($this->getBudget(), 300, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:10%">الميزانية</td>
                    </tr>
                    <tr>
                        <td style="width:43%; height:30px;">' . str_pad(date('d/m/Y', strtotime($this->getDatefin())), 40, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:7%">إلى</td>
                        <td style="width:40%"> ' . str_pad(date('d/m/Y', strtotime($this->getDatedebut())), 40, '.', STR_PAD_LEFT) . '</td>
                        <td style="width:10%">المدة من</td>
                    </tr>
                </table>&nbsp;<br>&nbsp;<br>&nbsp;<br>';

        $html.= '<table border="1" style="width: 100%; text-align:center;">
                    <tr style="font-weight:bold;">
                        <th style="width: 20%; height:30px; font-size:12px;">الوضعية الإدارية</th>
                        <th style="width: 15%; font-size:12px;">رقم التسجيل</th>
                        <th style="width: 20%; font-size:12px;">رقم ب ت و</th>
                        <th style="width: 40%; font-size:12px;">الاسم واللقب</th>
                        <th style="width: 5%"></th>
                    </tr>';

        $ligneovrier = Doctrine_Core::getTable('ligneattestationouvrier')->findByIdAttestation($this->getId());
        $i = 1;
        foreach ($ligneovrier as $ouv):
            $html.= '<tr>'
                    . '<td style="height:25px;">';
            if ($ouv->getOuvrier()->getContratouvrier()->getLast() != null)
                $html.=$ouv->getOuvrier()->getContratouvrier()->getLast()->getSituationadminouvrier()->getLibelle();
            $html.='</td>'
                    . '<td>' . $ouv->getOuvrier()->getMatricule() . '</td>'
                    . '<td>' . $ouv->getOuvrier()->getCin() . '</td>'
                    . '<td>' . $ouv->getOuvrier()->getNom() . '--' . $ouv->getOuvrier()->getPrenom() . '</td>'
                    . '<td>' . $i . '</td>'
                    . '</tr>';
            $i++;
        endforeach;

        for ($i = $ligneovrier->count() + 1; $i < 11; $i++)
            $html.= '<tr>
                        <td style="height:25px;">............................</td>
                        <td>..................</td>
                        <td>............................</td>
                        <td>...................................................</td>
                        <td>' . $i . '</td>
                    </tr>';

        $html.='</table>&nbsp;<br>&nbsp;<br>';

        $html.= '<table style="text-align: center; width:100%;">
                    <tr>
                        <td style="30%;height:100px;">المدير</td>
                        <td style="40%;">كاهية المدير</td>
                        <td style="30%;">رئيس المصلحة</td>
                    </tr>
                    <tr>
                        <td style="30%;"></td>
                        <td style="40%;">المدير العام</td>
                        <td style="30%;"></td>
                    </tr>
                </table>';
        
        return $html;
    }

}
