<?php

/**
 * DemandepretTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class DemandepretTable extends Doctrine_Table {

    /**
     * Returns an instance of this class.
     *
     * @return object DemandepretTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('Demandepret');
    }

    public function getByAgentEnCours($id_agents) {
        $q = Doctrine_Core::getTable('Demandepret')
                ->createQuery('d')
                ->where("d.datefinretenue > '" . date('Y-m-d') . "'")
                ->andWhere('d.id_agents = ' . $id_agents)
                ->andWhere("d.paye = false")
                ->orderBy('d.datedebutretenue')
                ->execute();

        return $q;
    }

    public function getDemande() {

        $query = $this->createQuery('l');
        $query->select('l.*')
                ->from('Demandepret l')
                ->where("l.mois <= '" . intval(date("m")) . "'")
                ->orWhere("l.annee <= '" . date("Y") . "'");

        return $query->execute();
    }

}
