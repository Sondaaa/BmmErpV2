<?php

/**
 * Papierordrepostal
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    PhpProject1
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Papierordrepostal extends BasePapierordrepostal {

    public function __toString() {
        return "" . $this->getrepapier();
        ;
    }

    public function ReadHtmlOrdre($id) {

        $ordre = PapierordrepostalTable::getInstance()->find($id);
        $societe = SocieteTable::getInstance()->findAll()->getFirst();

        $html = '&nbsp;<br>&nbsp;<br>&nbsp;<br>&nbsp;<br>&nbsp;<br>&nbsp;<br>&nbsp;<br>'
                . '<table><tr>'
                . '<td>'
                . '<table cellpadding="6">
                        <tr>
                            <td style="width:300px; text-align:center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                        </tr>
                    </table>
                    <table cellpadding="6">
                        <tr>
                            <td style="width:300px; text-align:center;">' . $ordre->getObjet() . '</td>
                        </tr>
                        <tr>
                            <td style="width:300px; text-align:center;">' . $ordre->getCible() . '</td>
                        </tr>
                     </table>'
                . '</td>'
                . '<td>'
                . '<table cellpadding="6">
                        <tr>
                            <td style="width:250px; text-align:center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                        </tr>
                    </table>
                    <table cellpadding = "6">
                    <tr>
                        <td style = "width:250px; text-align:center;">' . chiffreToLettre::cvnbst($ordre->getMnt()) . '</td>
                    </tr>
                    </table>
                    <table cellpadding = "6">
                    <tr>
                        <td style = "width:250px; text-align:center;">' . $ordre->getCible() . '</td>
                    </tr>
                    </table>&nbsp;<br>&nbsp;<br>&nbsp;<br>'
                . '<table>
                    <tr>
                        <td style = "width:100px;"></td>
                        <td style = "width:150px; font-size:10px;">' . $societe->getGouvernera()->getGouvernera() . '&nbsp;&nbsp;&nbsp;&nbsp;' . date('d-m-Y') . '</td>
                    </tr>
                    </table>
                    </td></tr></table>';

        return $html;
    }

    public function ReadHtmlOrdreVide($id, $id_bordereau) {
        $ordre = PapierordrepostalTable::getInstance()->find($id);

        $bordereau = BordereauvirementTable::getInstance()->find($id_bordereau);
        $mvt = $bordereau->getMouvementbanciare()->getFirst();
        $societe = SocieteTable::getInstance()->findAll()->getFirst();

        $html = '<h3>Ordre de retrait ou de virement N° : ' . $ordre->getRepapier() . '</h3>
                &nbsp;<br>&nbsp;<br>';

        $html.='<table border="1" cellspacing="0" cellpadding="3">
                    <tr>
                        <td style="width: 43%;">
                            <table border="1" cellpadding="3" cellspacing="0">
                                <tr>
                                    <td style="height: 31px;">Ordre N°</td>
                                    <td style="text-align: center;">' . $ordre->getRepapier() . '</td>
                                    <td style="text-align: right;">إذن رقم</td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: left;">
                                        ' . $societe->getRs() . '
                                        <br>
                                        ' . $societe->getAdresse() . '
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: center;">
                                        ' . FormatRib::ShowZone($ordre->getCarnetordrepostal()->getCaissesbanques()->getRib()) . '
                                        <table style="width: 100%;"><tr>
                                            <td style="width:35%; text-align: right;">RIP</td>
                                            <td style="width:3%;"></td>
                                            <td style="width:62%; text-align: left;">معرف الهوية البريدية لصاحب الحساب</td>
                                        </tr></table>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: left; height: 25px;">Montant en chiffres</td>
                                    <td style="text-align: center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                                    <td style="text-align: right;">المبلغ بالأرقام</td>
                                </tr>
                                <tr>
                                    <td style="text-align: left; height: 25px;">Objet du virement</td>
                                    <td></td>
                                    <td style="text-align: right;">موضوع التحويل</td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: center; height: 25px;">' . $ordre->getObjet() . '</td>
                                </tr>
                                <tr>
                                    <td style="height: 31px;">Au profit de</td>
                                    <td style="text-align: center;">';
        if (count($mvt) > 0)
            $html.= $mvt->getRefbenifi() . '  ' . FormatRib::Show($mvt->getRibbeni());

        $html.='</td>
                                    <td style="text-align: right;">لفائدة</td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="height: 90px;"></td>
                                </tr>
                            </table>
                        </td>
                        <td style="width: 57%; vertical-align: top;">
                            <table border="1" cellpadding="3" cellspacing="0">
                                <tr>
                                    <td style="height: 31px; width: 19%;">CCP N°</td>
                                    <td style="text-align: center; width: 24%;">' . $ordre->getCarnetordrepostal()->getCaissesbanques()->getCodecb() . '</td>
                                    <td style="width: 21%;">Ordre N°</td>
                                    <td style="text-align: center; width: 22%;">' . $ordre->getRepapier() . '</td>
                                    <td style="text-align: right; width: 14%;">إذن رقم</td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: left;">
                                        ' . $societe->getRs() . '
                                        <br>
                                        ' . $societe->getAdresse() . '
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: center;">
                                        ' . FormatRib::ShowZone($ordre->getCarnetordrepostal()->getCaissesbanques()->getRib()) . '
                                        <table style="width: 100%;"><tr>
                                            <td style="width:35%; text-align: right;">RIP</td>
                                            <td style="width:3%;"></td>
                                            <td style="width:62%; text-align: left;">معرف الهوية البريدية لصاحب الحساب</td>
                                        </tr></table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="height: 25px;">A payer / virer (Montant en chiffres)</td>
                                    <td style="text-align: center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                                    <td colspan="2" style="text-align: right;">يدفع / يحول (المبلغ بالأرقام) </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="height: 25px;">Montant en toutes lettres</td>
                                    <td></td>
                                    <td colspan="2" style="text-align: right;">المبلغ بالأحرف</td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: center; height: 25px;">' . chiffreToLettre::cvnbst($ordre->getMnt()) . '</td>
                                </tr>
                                <tr>
                                    <td style="height: 31px;">Au profit de</td>
                                    <td colspan="3" style="text-align: center;">';
        if (count($mvt) > 0)
            $html.= $mvt->getRefbenifi() . '  ' . FormatRib::Show($mvt->getRibbeni());

        $html.='</td>
                                    <td style="text-align: right;">لفائدة</td>
                                </tr>
                                <tr>
                                    
                                    <td colspan="5" style="height: 90px; font-size: 12px; text-align: center; letter-spacing: .2rem;">' . $societe->getGouvernera()->getGouvernera() . ' Le <b> ' . date('d-m-Y') . ' </b> في ' . $societe->getGouvernera()->getGouvernera() . '<br>
                                        <table style="width: 100%;">
                                        <tr>
                                            <td style="width:47%; text-align: right;"><i>SIGNATURE</i></td>
                                            <td style="width:6%;"></td>
                                            <td style="width:47%; text-align: left;">الإمضاء</td>
                                        </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>';

        return $html;
    }

    public function ReadHtmlBordereauVideretrait($id, $id_mvts) {
        $mvts = MouvementbanciareTable::getInstance()->find($id_mvts);
        $ordre = PapierordrepostalTable::getInstance()->find($id);
        $societe = SocieteTable::getInstance()->findAll()->getFirst();

        $html = '<h3>Ordre de retrait ou de virement N° : ' . $ordre->getRepapier() . '</h3>
                &nbsp;<br>';

        $html.='<table>
                    <tr>
                        <td style="width: 45%;">
                            <table border="1" cellpadding="3" cellspacing="0">
                                <tr>
                                    <td style="height: 31px;">Ordre N°</td>
                                    <td style="text-align: center;">' . $ordre->getRepapier() . '</td>
                                    <td style="text-align: right;">إذن رقم</td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: left;">
                                        ' . $societe->getRs() . '
                                        <br>
                                        ' . $societe->getAdresse() . '
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: center;">
                                        ' . FormatRib::ShowZone($ordre->getCarnetordrepostal()->getCaissesbanques()->getRib()) . '
                                        <table style="width: 100%;">
                                        <tr>
                                            <td style="width:25%; text-align: left;">RIP</td>
                                            <td style="width:5%;"></td>
                                            <td style="width:70%; text-align: left;">معرف الهوية البريدية لصاحب الحساب</td>
                                        </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: left; height: 57px;">Mnt en chiffres</td>
                                    <td style="text-align: center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                                    <td style="text-align: right;">المبلغ بالأرقام</td>
                                </tr>
                                <tr>
                                <td colspan="3" style="text-align: center;height: 42px;">';
        $html.='<table style="width: 100%;">
                             <tr>
                                <td style="width:30%; text-align: left;">Objet du virement: </td>
                                <td style="width:40%;">' . trim($ordre->getObjet()) . '</td>
                                <td style="width:30%; text-align: right;">موضوع التحويل: </td>
                                </tr>
                                </table>
                                </td>
                              </tr>';
        $html.='<tr><td colspan="3" style="text-align: center;height: 111px;">';
        $html.='<table style="width: 100%;">
                             <tr>
                                <td style="width:22%; text-align: left;">Au profit de: </td>
                                <td style="width:58%;">' . $mvts->getRefbenifi();
//        if (FormatRib::Show($mvts->getRibbeni()))
//            $html.= FormatRib::Show($mvts->getRibbeni());
//        else
            $html.='<br>'. $mvts->getRibbeni();
        $html.='</td>
                                <td style="width:20%; text-align: rigth;">لفائدة :</td>
                                </tr>
                                </table>
                                </td>
                              </tr>';
        $html.='  </table>
                        </td>
                        <td style="width: 55%; vertical-align: top;">
                            <table border="1" cellpadding="3" cellspacing="0">
                                <tr>
                                    <td style="height: 31px; width: 19%;">CCP N°</td>
                                    <td style="text-align: center; width: 24%;">' . $ordre->getCarnetordrepostal()->getCaissesbanques()->getCodecb() . '</td>
                                    <td style="width: 21%;">Ordre N°</td>
                                    <td style="text-align: center; width: 22%;">' . $ordre->getRepapier() . '</td>
                                    <td style="text-align: right; width: 14%;">إذن رقم</td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: left;">
                                        ' . $societe->getRs() . '
                                        <br>
                                        ' . $societe->getAdresse() . '
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: center;">
                                        ' . FormatRib::ShowZone($ordre->getCarnetordrepostal()->getCaissesbanques()->getRib()) . '
                                        <table style="width: 100%;"><tr>
                                            <td style="width:35%; text-align: left;">RIP</td>
                                            <td style="width:3%;"></td>
                                            <td style="width:62%; text-align: rigth;">معرف الهوية البريدية لصاحب الحساب</td>
                                        </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>';
        $html.=' <td colspan="5" style="text-align: center;height: 35px;">
            <table style="width: 100%;" ><tr>
                                            <td style="width:20%; text-align: left;">A payer / virer <br>(Mnt en chiffres)</td>
                                            <td style="width:60%;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
                                            <td style="width:20%; text-align: rigth;">يدفع / يحول (المبلغ بالأرقام)</td>
                                        </tr>
                                        </table>';
//                                    <td colspan="2" style="height: 45px;">A payer / virer <br>(Mnt en chiffres)</td>
//                                    <td style="text-align: center;">' . number_format($ordre->getMnt(), 3, '.', ' ') . '</td>
//                                    <td colspan="2" style="text-align: right;">يدفع / يحول (المبلغ بالأرقام) </td>
        $html.='</td></tr><tr>';

        $html.=' <td colspan = "5" style = "height: 25px;">
                <table style="width: 100%;"><tr>
                                            <td style="width:30%; text-align: left;">Mnt en toutes lettres :</td>
                                            <td style="width:40%;"><b>' . chiffreToLettre::cvnbst($ordre->getMnt()) . '</b></td>
                                            <td style="width:30%; text-align: rigth;">المبلغ بالأحرف :</td>
                                        </tr>
                                        </table></td>';
//                . '<span class = "pull-left">Mnt en toutes lettres : </span>'
//                . '&nbsp;<span class = "pull-right">المبلغ بالأحرف : </span>'
//                . '<br><span style = "text-align:center">' . chiffreToLettre::cvnbst($ordre->getMnt()) . '</span></td>';

        $html.=' </tr>
        <tr style = "height:30px;">';
//        $html.=' 
//                                    <td style="height: 57px;">Au profit de</td>
//                                    <td colspan="3" style="text-align: center;">' .
//                $mvts->getRefbenifi() . '  ' . FormatRib::Show($mvts->getRibbeni())
//                . '</td>
//                                    <td style="text-align: right;">لفائدة</td>
//                                ';
        $html.=' <td colspan = "5" style = "height: 25px;">
                <table style="width: 100%;">
                <tr>
                    <td style="width:20%; text-align: left;">Au profit de : </td>
                    <td style="width:60%;"><b>' .
                    $mvts->getRefbenifi().'<br>'. $mvts->getRibbeni(). '</b></td>
                            <td style="width:20%; text-align: rigth;">لفائدة :</td>
                        </tr>
                </table></td>';
//        $html.=' <td colspan = "5" style = "height:40px;"><span class = "pull-left">Au profit de : </span>'
//                . '<span class = "pull-right">لفائدة : </span><br><span style = "text-align:center">' .
//                $mvts->getRefbenifi() . ' <br> ' . FormatRib::Show($mvts->getRibbeni())
//                . '</span></td>';


        $html.='      </tr>
                                <tr>
                                    
                                    <td colspan="5" style="height: 80px; font-size: 12px; text-align: center; letter-spacing: .2rem;">' . $societe->getGouvernera()->getGouvernera() . ' Le  ' . date('d-m-Y') . ' في ' . '<br>
                                        <table style="width: 100%;">
                                        <tr>
                                            <td style="width:47%; text-align: right;"><i>SIGNATURE</i></td>
                                            <td style="width:6%;"></td>
                                            <td style="width:47%; text-align: left;">الإمضاء</td>
                                        </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>';

        return $html;
    }

}
