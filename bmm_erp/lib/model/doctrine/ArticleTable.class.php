<?php

/**
 * ArticleTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class ArticleTable extends Doctrine_Table {

    /**
     * Returns an instance of this class.
     *
     * @return object ArticleTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('Article');
    }
    
    public function load($code, $designation, $famille, $sous_famille, $nature,$unite) {
        $query = $this->createQuery('a');
        $query->select('a.*')
                ->from('Article a');

        if ($code != '')
            $query->andWhere("UPPER(a.codeart) LIKE '%" . strtoupper($code) . "%'");

        if ($designation != '')
            $query->andWhere("UPPER(a.designation) LIKE '%" . strtoupper($designation) . "%'");

        if ($famille != '' && $famille != '0' && $famille != 'null')
            $query->andWhere("a.id_famille =" . $famille);

        if ($sous_famille != '' && $sous_famille != '0' && $sous_famille != 'null')
            $query->andWhere("a.id_sousfamille =" . $sous_famille);

        if ($nature != '' && $nature != '0' && $nature != 'null')
            $query->andWhere("a.id_nature =" . $nature);
         if ($unite != '' && $unite != '0' && $unite != 'null')
            $query->andWhere("a.id_unite =" . $unite);

        $query->orderBy('a.designation, a.codeart');
        return $query;
    }

    public function getByListeLibelle($libelles) {
        $q = $this->createQuery('d')
                ->whereIn('upper(trim(d.designation))', (array) $libelles)
                ->execute();
        return $q;
    }
}
