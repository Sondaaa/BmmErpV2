<?php

/**
 * Agents
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    PhpProjectTest
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Agents extends BaseAgents {

//liste agents 
    public function ReadHtmAlllListeAgents(sfWebRequest $request) {

        $idrh = $request->getParameter('idrh', '');
        $cin = $request->getParameter('cin', '');
//        $nom = $request->getParameter('nom', '');
//        $prenom = $request->getParameter('prenom', '');
//        $id_regroupement = $request->getParameter('id_regroupement', '');
//        if ($id_regroupement != '') {
//            $regroupement = Doctrine_Core::getTable('regroupementagents')->findOneById($id_regroupement);
//        }
        $conn = Doctrine_Manager::getInstance()->getCurrentConnection();
        $q = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('a.*,a.id as agents_id, Concat(a.nomcomplet, a.prenom) as nom')
                ->from('Agents a')
                ->leftJoin('a.Regroupementagents r');

        if ($id_regroupement != '')
            $q->where('r.id = ' . $id_regroupement);
        if ($idrh != '')
            $q->andWhere("a.idrh like %'" . $idrh . "%'");
        if ($cin != '')
            $q->andWhere("a.idrh like %'" . $cin . "%'");
        
//        if ($nom != '')
//            $q->andWhere("a.nomcomplet like '%" . $nom . "%'");
//        if ($prenom != '')
//            $q->andWhere("a.prenom like '%" . $prenom . "%'");

        $q->orderBy('nom');
        $agents = $q->execute();

        $html = '<h3>Liste des Agents</h3>
                    &nbsp;<br>
                    <table border="1" cellpadding="3">
                        <tr>
                            <td style="width:100%;">
                                <span style="margin-top:10px; color:#000;font-weight:bold;font-size:14px;">Recherche suivant :</span>
                                <ul style="width:100%;">';

//        if ($id_regroupement != ''):
//            $regroupement = Doctrine_Core::getTable('regroupementagents')->findOneById($id_regroupement);
//            $html.='<li> Regroupement : ' . $regroupement->getLibelle() . '</li>';
//        else:
//            $html.='<li> Regroupement : - </li>';
//        endif;
        if ($idrh != ''):
            $html.='<li> Matricule : ' . $idrh . '</li>';
        else:
            $html.='<li> Matricule : - </li>';
        endif;
        if ($cin != ''):
            $html.='<li> Cin : ' . $cin . '</li>';
        else:
            $html.='<li> Cin : - </li>';
        endif;

//        if ($nom != ''):
//            $html.='<li> Nom : ' . $nom . '</li>';
//        else:
//            $html.='<li> Nom : - </li>';
//        endif;
//        if ($prenom != ''):
//            $html.='<li> Prénom : ' . $prenom . '</li>';
//        else:
//            $html.='<li> Prénom : - </li>';
//        endif;
        $html.='</ul>
        </td>
        </tr>
        </table>&nbsp;
        <br>
        <table border = "1" cellpadding = "3">
            <tbody>
                <tr style="background-color:#EDEDED;font-weight:bold;">
                    <td style="width:7%;text-align:center;height:30px;font-size:14px;"><label>N°</label></td>
                    <td style="width:18%;text-align:center;"><label>Matricule</label></td>
                    <td style="width:40%;text-align:center;"><label>Nom & Prénom</label></td>
                    <td style="width:15%;text-align:center;"><label>CIN</label></td>
                    <td style="width:20%;text-align:center;"><label>Regroupement</label></td>
                </tr>';
        $i = 1;
        foreach ($agents as $agent):
            $html.='<tr>
                        <td style="width:7%;text-align:center;">' . $i . '</td>
                        <td style="width:18%;text-align:center;">' . $agent->getIdrh() . '</td>
                        <td style="width:40%;">' . $agent->getNomcomplet() . " " . $agent->getPrenom() . '</td>
                        <td style="width:15%;text-align:center;">' . $agent->getCin() . '</td>
                        <td style="width:20%;text-align:center;">' . $agent->getRegroupementagents() . '</td>
                    </tr>';
            $i++;
        endforeach;
        $html.='</tbody>
        </table>';
        return $html;
    }

    public function ReadHtmllisteAgentsAllFilter($idreg, $ido, $idf, $iddebut, $idfin, $idd, $idr, $ids, $idu) {

        $q = Doctrine_Query::create()
                ->select('a.*')
                ->from('agents a, regroupementtheme r, contrat c, besoinsdeformation b, planing pl, ligneplaning lp, rubriqueformation ru, sousrubrique s, unite u, posterh p')
                ->where('lp.id_besoins=b.id and b.id_agents=a.id')
                ->andWhere('lp.realise=true');

        if ($idregr != '')
            $q = $q->andWhere('lp.id_regroupement=r.id')
                    ->andWhere('r.id= ?', $idregr);
        if ($ido != '')
            $q = $q->andWhere('lp.id_fournisseur= ?', $ido);
        if ($idf != '')
            $q = $q->andWhere('lp.id_formateur= ?', $idf);
        if ($iddebut != '')
            $q = $q->andWhere('lp.id_pluning=pl.id')
                    ->andWhere('pl.annee >= ?', $iddebut);
        if ($idfin != '')
            $q = $q->andWhere('lp.id_pluning=pl.id')
                    ->andWhere('pl.annee <= ?', $idfin);
        if ($idd != '')
            $q = $q->andWhere('lp.id_sousrubrique=s.id')
                    ->andWhere('s.id_rubrique=ru.id')
                    ->andWhere('ru.id_domaine= ?', $idd);
        if ($idr != '')
            $q = $q->andWhere('lp.id_sousrubrique=s.id')
                    ->andWhere('s.id_rubrique= ?', $idr);
        if ($ids != '')
            $q = $q->andWhere('lp.id_sousrubrique= ?', $ids);
        if ($idu != '')
            $q = $q->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                    ->andWhere('u.id= ?', $idu);

        $listes = $q->execute();

        $html = '<h3>Liste des Agents Participants à la Formation</h3>
            &nbsp;<br>
                    <table border="1" cellpadding="3">
                        <tr>
                            <td style="width:100%;">
                                <span style="margin-top:10px;color:#000;font-weight:bold;font-size:14px;">Recherche suivant :</span>
                                    <ul style="width:100%;">';

        if ($idregr != ''):
            $reg = Doctrine_Core::getTable('regroupementtheme')->findOneById($idregr);
            $html.='<li>' . $reg->getLibelle() . '</li>';
        endif;
        if ($ido != ''):
            $four = Doctrine_Core::getTable('fournisseur')->findOneById($ido);
            $html.='<li>de l\'organisme ' . $four->getRs() . '</li>';
        endif;
        if ($idf != ''):
            $for = Doctrine_Core::getTable('formateur')->findOneById($idf);
            $html.='<li>avec le Formateur ' . trim($for->getNom()) . ' ' . $for->getPrenom() . '</li>';
        endif;
        if ($iddebut != ''):
            $html.='<li>dés ' . $iddebut . '</li>';
        endif;
        if ($idfin != ''):
            $html.='<li>Avant ' . $idfin . '</li>';
        endif;
        if ($idd != ''):
            $domaine = Doctrine_Core::getTable('domaineuntilisation')->findOneById($idd);
            $html.='<li>du Domaine d\'utilisation ' . $domaine->getLibelle() . '</li>';
        endif;
        if ($idr != ''):
            $rubrique = Doctrine_Core::getTable('rubriqueformation')->findOneById($idr);
            $html.='<li>du Rubrique ' . $rubrique->getLibelle() . '</li>';
        endif;
        if ($ids != ''):
            $sousrubrique = Doctrine_Core::getTable('sousrubrique')->findOneById($ids);
            $html.='<li>du Sous Rubrique ' . $sousrubrique->getLibelle() . '</li>';
        endif;
        if ($idu != ''):
            $unite = Doctrine_Core::getTable('unite')->findOneById($idu);
            $html.='<li>de ' . $unite->getLibelle() . '</li>';
        endif;
        $html.='</ul>
                    </td>
                </tr>
            </table>&nbsp;<br>
            <table border="1" cellpadding="3">
                <tbody>
                    <tr style="background-color:#EDEDED;font-weight:bold;">
                        <td style="width:10%;text-align:center;height:30px;font-size:14px;"><label>N°</label></td>
                        <td style="width:30%;text-align:center;"><label>Matricule</label></td>
                        <td style="width:40%;text-align:center;"><label>Nom & Prénom</label></td>
                        <td style="width:20%;text-align:center;"><label>CIN</label></td>
                    </tr>';
        $i = 1;
        if (sizeof($listes) > 0):
            foreach ($listes as $p):
                $html.='<tr>
                        <td style="width:10%;text-align:center;">' . $i . '</td>
                        <td style="width:30%;text-align:center;">' . $p->getIdrh() . '</td>
                        <td style="width:40%;">' . $p->getNomComplet() . '</td>
                        <td style="width:20%;text-align:center;">' . $p->getCin() . '</td>
                    </tr>';
                $i++;
            endforeach;
        else:
            $html.='<tr><td style="width:100%;text-align:center;">Pas d\'historique</td></tr>';
        endif;
        $html.='</tbody>
                </table>';
        return $html;
    }

//-----------all filrage par agents 

    public function ReadHtmllisteAgentsAllFilterParAgents($idag, $ido, $idF, $iddebut, $idfin, $idd, $idr, $ids, $idu) {

        $q = Doctrine_Query::create()
                ->select('bes.*')
                ->from(' besoinsdeformation bes,agents a,ligneplaning lp,planing pl, rubriqueformation ru, sousrubrique s, contrat c,  unite u, posterh p')
                ->where('lp.id_besoins=bes.id and bes.id_agents=a.id')
                ->andWhere('lp.realise=true');

        if ($idag != '')
            $q = $q->andWhere('a.id= ?', $idag);
        if ($iddebut != '')
            $q = $q->andWhere('lp.id_pluning=pl.id')
                    ->andWhere('pl.annee >= ?', $iddebut);
        if ($idfin != '')
            $q = $q->andWhere('lp.id_pluning=pl.id')
                    ->andWhere('pl.annee <= ?', $idfin);
        if ($ido != '')
            $q = $q->andWhere('lp.id_fournisseur= ?', $ido);
        if ($idF != '')
            $q = $q->andWhere('lp.id_formateur= ?', $idF);
//                               
//                              
        if ($idd != '')
            $q = $q->andWhere('lp.id_sousrubrique=s.id')
                    ->andWhere('s.id_rubrique=ru.id')
                    ->andWhere('ru.id_domaine= ?', $idd);
        if ($idr != '')
            $q = $q->andWhere('lp.id_sousrubrique=s.id')
                    ->andWhere('s.id_rubrique= ?', $idr);
        if ($ids != '')
            $q = $q->andWhere('lp.id_sousrubrique= ?', $ids);
        if ($idu != '')
            $q = $q->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                    ->andWhere('u.id= ?', $idu);
        $listes = $q->execute();

        $html = '<h3>Liste des Formations </h3>
            &nbsp;<br>
                    <table border="1" cellpadding="3">
                        <tr>
                            <td style="width:100%;">
                                <span style="margin-top:10px;color:#000;font-weight:bold;font-size:14px;">Recherche suivant :</span>
                                    <ul style="width:100%;">';

        if ($idag != ''):
            $agents = Doctrine_Core::getTable('agents')->findOneById($idag);
            $html.='<li>' . $agents->getNomcomplet() . " " . $agents->getPrenom() . '</li>';
        endif;
        if ($ido != ''):
            $four = Doctrine_Core::getTable('fournisseur')->findOneById($ido);
            $html.='<li>de l\'organisme ' . $four->getRs() . '</li>';
        endif;
        if ($idF != ''):
            $for = Doctrine_Core::getTable('formateur')->findOneById($idF);
            $html.='<li>avec le Formateur ' . $for->getNom() . ' ' . $for->getPrenom() . '</li>';
        endif;
        if ($iddebut != ''):
            $html.='<li>dés ' . $iddebut . '</li>';
        endif;
        if ($idfin != ''):
            $html.='<li>Avant ' . $idfin . '</li>';
        endif;
        if ($idd != ''):
            $domaine = Doctrine_Core::getTable('domaineuntilisation')->findOneById($idd);
            $html.='<li>du Domaine d\'utilisation ' . $domaine->getLibelle() . '</li>';
        endif;
        if ($idr != ''):
            $rubrique = Doctrine_Core::getTable('rubriqueformation')->findOneById($idr);
            $html.='<li>du Rubrique ' . $rubrique->getLibelle() . '</li>';
        endif;
        if ($ids != ''):
            $sousrubrique = Doctrine_Core::getTable('sousrubrique')->findOneById($ids);
            $html.='<li>du Sous Rubrique ' . $sousrubrique->getLibelle() . '</li>';
        endif;
        if ($idu != ''):
            $unite = Doctrine_Core::getTable('unite')->findOneById($idu);
            $html.='<li>de ' . $unite->getLibelle() . '</li>';
        endif;
        $html.='</ul>
                    </td>
                </tr>
            </table>&nbsp;<br>
            <table border="1" cellpadding="3">
                <tbody>
                    <tr style="background-color:#EDEDED;font-weight:bold;">
                        <td style="width:10%;text-align:center;height:30px;font-size:14px;"><label>N°</label></td>
                        <td style="width:50%;text-align:center;"><label>Formation</label></td>
                        <td style="width:40%;text-align:center;"><label>Année</label></td>
                    </tr>';
        $i = 1;
        foreach ($listes as $p):
            $html.='<tr>
                        <td style="width:10%;text-align:center;">' . $i . '</td>
                        <td style="width:50%;text-align:left;">' . $p->getBesoins() . '</td>
                        <td style="width:40%;text-align:center;">' . $p->getAnnee() . '</td>
                    </tr>';
            $i++;
        endforeach;
        $html.='</tbody>
                </table>';
        return $html;
    }

//----------------    
    public function ReadHtmllisteAgentsparRegrouppement($idd) {
        $reg = Doctrine_Core::getTable('regroupementtheme')->findOneById($idd);

        $html = ' <h3>Liste des Employés participants à la formation  "' . $reg->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('r.id= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//par sous rubrique 

    public function ReadHtmllisteAgentsparSousrubrique($idd) {
        $sousrubrique = Doctrine_Core::getTable('sousrubrique')->findOneById($idd);

        $html = ' <h3>Liste des Employés participants à la formation de Sous Rubrique  "' . $sousrubrique->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_sousrubrique= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//par Rubrique 


    public function ReadHtmllisteAgentsparRubrique($idd) {
        $rubrique = Doctrine_Core::getTable('rubriqueformation')->findOneById($idd);

        $html = ' <h3>Liste des Employés participants à la formation de Sous Rubrique  "' . $rubrique->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agents</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r,sousrubrique s , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_sousrubrique=s.id')
                ->andWhere('s.id_rubrique= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//par domaine dutilisatiion 

    public function ReadHtmllisteAgentsparDomaine($idd) {
        $domaine = Doctrine_Core::getTable('domaineuntilisation')->findOneById($idd);

        $html = ' <h3>Liste des Employés participants à la formation du domaine d\'utilisation  "' . $domaine->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,sousrubrique s,rubriqueformation ru , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_sousrubrique=s.id')
                ->andWhere('s.id_rubrique=ru.id')
                ->andWhere('ru.id_domaine= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//par domaine et sous rubrique 

    public function ReadHtmllisteAgentsparDomaineSousRubrique($idd, $ids) {
        $domaine = Doctrine_Core::getTable('domaineuntilisation')->findOneById($idd);
        $sous = Doctrine_Core::getTable('sousrubrique')->findOneById($ids);

        $html = ' <h3>Liste des Employés participants à la formation du domaine d\'utilisation  "' . $domaine->getLibelle() . 'et le Sous Rubrique " ' . $sous->getlibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,sousrubrique s,rubriqueformation ru , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_sousrubrique=s.id')
                ->andWhere('lp.id_sousrubrique=' . $ids)
                ->andWhere('s.id_rubrique=ru.id')
                ->andWhere('ru.id_domaine= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//impression par organisme 

    public function ReadHtmllisteAgentsparOrganisme($idd) {

        $four = Doctrine_Core::getTable('fournisseur')->findOneById($idd);
        $html = ' <h3>Liste des Employés   participants à La Formation de l organisme  "' . $four->getRs() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,besoinsdeformation b,planing pl ,ligneplaning lp, posterh p ,unite u  ')
                ->where('lp.id_besoins=b.id ')
                ->andWhere(' b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_fournisseur= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//impression par formateur 

    public function ReadHtmllisteAgentsparFormateur($idd) {

        $for = Doctrine_Core::getTable('formateur')->findOneById($idd);
        $html = ' <h3>Liste des Employés   participants à La Formation avec le formateur  "' . $for->getNom() . "  " . $for->getPrenom() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,besoinsdeformation b,planing pl ,ligneplaning lp')
                ->where('lp.id_besoins=b.id ')
                ->andWhere(' b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('lp.id_formateur= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//liste agents  par annee

    public function ReadHtmllisteAgentsparAnnee($idd) {

        $html = ' <h3>Liste des Employés participants à la formation en "' . $idd . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//liste agents par unite **

    public function ReadHtmllisteAgentsparUniteFormation($idd) {
        $unite = Doctrine_Core::getTable('unite')->findOneById($idd);

        $html = ' <h3>Liste des Employés de "' . $unite->getLibelle() . '"' . "participants à la formation " . '
            </h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 20%;"><label>Matricule</label></td>
                        <td style="width: 30%;"><label>Nom & Prénom</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                          <td style="width: 20%;"><label>Année</label></td>
                                 
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,besoinsdeformation b,planing pl ,ligneplaning lp,contrat c , posterh p ,unite u  ')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                ->andWhere('u.id= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>'
                    . '<td>' . $p->getCin() . '</td>'
                    . '<td>' . $p->getBesoinsdeformation()->getFirst()->getAnnee() . '</td>'
                    . '</tr>';

            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//unite et par regreoupppment de formation,

    public function ReadHtmllisteAgentsparUniteRegroupement($idd, $idreg) {
        $unite = Doctrine_Core::getTable('unite')->findOneById($idd);
        $regr = Doctrine_Core::getTable('regroupementtheme')->findOneById($idreg);

        $html = ' <h3>Liste des Employés de "' . $unite->getLibelle() . '"' . 'participants à la formation" ' . $regr->getLibelle() . '"' . '
            </h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 20%;"><label>Matricule</label></td>
                        <td style="width: 30%;"><label>Nom & Prénom</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                          <td style="width: 20%;"><label>Année</label></td>
                                 
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r,besoinsdeformation b,planing pl ,ligneplaning lp,contrat c , posterh p ,unite u  ')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id  and lp.id_regroupement=r.id')
                ->andWhere('lp.realise=true')
                ->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                ->andWhere('u.id= ?', $idd)
                ->andWhere('r.id=' . $idreg)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>'
                    . '<td>' . $p->getCin() . '</td>'
                    . '<td>' . $p->getBesoinsdeformation()->getFirst()->getAnnee() . '</td>'
                    . '</tr>';

            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //unite et organisme 

    public function ReadHtmllisteAgentsparUniteOrganisme($idd, $ido) {
        $unite = Doctrine_Core::getTable('unite')->findOneById($idd);
        $four = Doctrine_Core::getTable('fournisseur')->findOneById($ido);

        $html = ' <h3>Liste des Employés de "' . $unite->getLibelle() . '"' . 'participants à la formation avec l\'organisme " ' . $four->getRs() . '"' . '
            </h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 20%;"><label>Matricule</label></td>
                        <td style="width: 30%;"><label>Nom & Prénom</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                          <td style="width: 20%;"><label>Année</label></td>
                                 
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,besoinsdeformation b,planing pl ,ligneplaning lp,contrat c , posterh p ,unite u  ')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id')
                ->andWhere('lp.realise=true')
                ->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                ->andWhere('u.id= ?', $idd)
                ->andWhere('lp.id_fournisseur=' . $ido)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>'
                    . '<td>' . $p->getCin() . '</td>'
                    . '<td>' . $p->getBesoinsdeformation()->getFirst()->getAnnee() . '</td>'
                    . '</tr>';

            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//unite et  formateur 

    public function ReadHtmllisteAgentsparUniteFormateur($idd, $idF) {
        $unite = Doctrine_Core::getTable('unite')->findOneById($idd);
        $for = Doctrine_Core::getTable('formateur')->findOneById($idF);

        $html = ' <h3>Liste des Employés de "' . $unite->getLibelle() . '"' . 'participants à la formation avec le Formateur " ' . $for->getNom() . " " . $for->getPrenom() . '"' . '
            </h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 20%;"><label>Matricule</label></td>
                        <td style="width: 30%;"><label>Nom & Prénom</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                          <td style="width: 20%;"><label>Année</label></td>
                                 
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,besoinsdeformation b,planing pl ,ligneplaning lp,contrat c , posterh p ,unite u  ')
                ->where('lp.id_besoins=b.id  and b.id_agents=a.id')
                ->andWhere('lp.realise=true')
                ->andWhere('c.id_agents=a.id and c.id_posterh=p.id and p.id_unite=u.id')
                ->andWhere('u.id= ?', $idd)
                ->andWhere('lp.id_formateur=' . $idF)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>'
                    . '<td>' . $p->getCin() . '</td>'
                    . '<td>' . $p->getBesoinsdeformation()->getFirst()->getAnnee() . '</td>'
                    . '</tr>';

            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//liste agents par annee debut 


    public function ReadHtmllisteAgentsparAnneeDebut($idd) {

        $html = ' <h3>Liste des Employés  participants à la formation en "' . $idd . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee= ?', $idd)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //annee debuiut et fin 

    public function ReadHtmllisteAgentsparAnneeDebutFin($idd, $idf) {

        $html = ' <h3>Liste des Employés  participants à la formation entre "' . $idd . '-' . $idf . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c , besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee >= ?', $idd)
                ->andWhere('p.annee <= ?', $idf)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//anne debut et unite 


    public function ReadHtmllisteAgentsparAnneeDebutUnite($idd, $idu) {

        $unite = Doctrine_Core::getTable('unite')->findOneById($idu);
        $html = ' <h3>Liste des Employés  de "' . $unite->getLibelle() . '" participants à la formation de l\'année "' . $idd . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c ,posterh pote ,unite u, besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee = ?', $idd)
                ->andWhere('c.id_agents=a.id and c.id_posterh=pote.id and pote.id_unite=u.id')
                ->andWhere('u.id= ?', $idu)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //annee fin et unite 

    public function ReadHtmllisteAgentsparAnneefinUnite($idd, $idu) {

        $unite = Doctrine_Core::getTable('unite')->findOneById($idu);
        $html = ' <h3>Liste des Employés  de "' . $unite->getLibelle() . '" participants à la formation de l\'année "' . $idd . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c ,posterh pote ,unite u, besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee = ?', $idd)
                ->andWhere('c.id_agents=a.id and c.id_posterh=pote.id and pote.id_unite=u.id')
                ->andWhere('u.id= ?', $idu)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//anne debut et fin et unite 

    public function ReadHtmllisteAgentsparAnneeDebutFinUnite($idd, $idf, $idunite) {
        $unite = Doctrine_Core::getTable('unite')->findOneById($idunite);
        $html = ' <h3>Liste des Employés de ' .
                $unite->getLibelle() . '  participants à la formation entre "' . $idd . '-' . $idf . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Query::create()
                ->select('*')
                ->from('agents a,regroupementtheme r , contrat c ,posterh pote ,unite u, besoinsdeformation b, planing p ,ligneplaning lp')
                ->where('lp.id_besoins=b.id and lp.id_regroupement=r.id and b.id_agents=a.id  ')
                ->andWhere('lp.realise=true')
                ->andWhere('p.annee >= ?', $idd)
                ->andWhere('p.annee <= ?', $idf)
                ->andWhere('c.id_agents=a.id and c.id_posterh=pote.id and pote.id_unite=u.id')
                ->andWhere('u.id= ?', $idunite)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //impression liste agents 
    public function ReadHtmlliste($idd, $idf) {
        $agentsd = Doctrine_Core::getTable('agents')->findOneById($idd);
        $agentsf = Doctrine_Core::getTable('agents')->findOneById($idf);

        $html = ' <h3>Liste des Employés  Entre "' . $agentsd->getNomcomplet() . " " . $agentsd->getPrenom() . '" ET "' . $agentsf->getNomcomplet() . " " . $agentsf->getPrenom() . '" </h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr>
                       <td style="width: 10%;"><label>Numéro</label></td>
                        
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Nom Complet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->where('id >=' . $idd)
                ->andWhere('id <=' . $idf)
                ->execute();

        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>' .
                    '<td>' . $i . '</td>'
                    . ' <td>' . $p->getIdrh() . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>'
                    . '<td>' . $p->getCin() . '</td>'
                    . '</tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par directions

    public function ReadHtmllisteAgentspardirections($idd) {
        $directio = Doctrine_Core::getTable('direction')->findOneById($idd);

        $html = ' <h3>Liste des Employés de la direction "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s, sousdirection sd , direction d ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id and  s.id_sousdirection=sd.id and sd.id_direction=d.id  ')
                ->andWhere('d.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agnets par corps

    public function ReadHtmllisteAgentsparcorps($idd) {
        $directio = Doctrine_Core::getTable('corps')->findOneById($idd);

        $html = ' <h3>Liste des Employés du corps  "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id')
                ->andWhere('cor.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>'
                    . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

// agents par unite
    public function ReadHtmllisteAgentsparunite($idd) {
        $directio = Doctrine_Core::getTable('unite')->findOneById($idd);

        $html = ' <h3>Liste des Employés reliés au unité"' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u  ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id')
                ->andWhere('u.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par echelle 

    public function ReadHtmllisteAgentsparechelle($idd) {
        $directio = Doctrine_Core::getTable('echelle')->findOneById($idd);

        $html = ' <h3>Liste des Employés reliés au l"echelle"' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, echelle e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_echelle=e.id')
                ->andWhere('e.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par lieu de travail 

    public function ReadHtmllisteAgentsparlieu($idd) {
        $directio = Doctrine_Core::getTable('lieutravail')->findOneById($idd);

        $html = ' <h3>Liste des Employés affectés au "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , lieutravail l ')
                ->where('c.id_agents=a.id and c.id_lieu=l.id')
                ->andWhere('l.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par echelon 

    public function ReadHtmllisteAgentsparechelon($idd) {
        $directio = Doctrine_Core::getTable('echelon')->findOneById($idd);

        $html = ' <h3>Liste des Employés reliés  au echelon "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, echelon e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_echelon=e.id')
                ->andWhere('e.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par categorie

    public function ReadHtmllisteAgentsparcat($idd) {
        $directio = Doctrine_Core::getTable('categorierh')->findOneById($idd);

        $html = ' <h3>Liste des Employés reliés  au catégorie "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_categorie=cat.id')
                ->andWhere('cat.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par grade

    public function ReadHtmllisteAgentspargrade($idd) {
        $directio = Doctrine_Core::getTable('grade')->findOneById($idd);

        $html = ' <h3>Liste des Employés reliés  au grade "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_grade=g.id')
                ->andWhere('g.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //agents par primes 

    public function ReadHtmllisteAgentsparprimes($idd) {
        $directio = Doctrine_Core::getTable('titreprimes')->findOneById($idd);

        $html = ' <h3>Liste des Employés' . '</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , primes p, titreprimes titrep,ligneprimecontrat lignecp')
                ->where('lignecp.id_contrat=c.id and lignecp.id_prime=p.id and  c.id_agents=a.id and p.id_titreprime=titrep.id')
                ->andWhere('titrep.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par poste
    public function ReadHtmllisteAgentsparposte($idd) {
        $directio = Doctrine_Core::getTable('posterh')->findOneById($idd);

        $html = ' <h3>Liste des Employés du poste"' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                   <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ')
                ->where('c.id_agents=id and c.id_posterh=p.id')
                ->andWhere('p.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par fonction 
    public function ReadHtmllisteAgentsparfonction($idd) {
        $directio = Doctrine_Core::getTable('fonction')->findOneById($idd);

        $html = ' <h3>Liste des Employés du fonction"' . $directio->getDescription() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , fonction f ')
                ->where('c.id_agents=a.id and c.id_fonction=f.id')
                ->andWhere('f.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par sitution
    public function ReadHtmllisteAgentsparsituation($idd) {
        $directio = Doctrine_Core::getTable('typecontrat')->findOneById($idd);

        $html = ' <h3>Liste des Employés "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                  <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , typecontrat t ')
                ->where('c.id_agents=a.id and c.id_typecontrat=t.id')
                ->andWhere('t.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par position 


    public function ReadHtmllisteAgentsparposition($idd) {
        $directio = Doctrine_Core::getTable('positionadministratif')->findOneById($idd);

        $html = ' <h3>Liste des Employés "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                 <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , positionadministratif p ')
                ->where('c.id_agents=a.id and c.id_positionadmini=p.id')
                ->andWhere('p.id= ?', $idd)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par debut fin et direction 
    public function ReadHtmllisteAgentspardirectionsetpardebutetfin($iddirection, $iddebut, $idfin) {
        $directio = Doctrine_Core::getTable('direction')->findOneById($iddirection);
        $agdebut = Doctrine_Core::getTable('agents')->findOneById($iddebut);
        $agfin = Doctrine_Core::getTable('agents')->findOneById($idfin);
        $html = ' <h3>Liste des Employés de la direction " ' . $directio->getLibelle() . '" entre l\'employé "' . $agdebut->getNomcomplet() . " " . $agdebut->getPrenom() . '" ET "' . $agfin->getNomcomplet() . " " . $agfin->getPrenom() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>
                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s, sousdirection sd , direction d ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id and  s.id_sousdirection=sd.id and sd.id_direction=d.id  ')
                ->andWhere('d.id= ?', $iddirection)
                ->andWhere('id>=' . $iddebut)
                ->andWhere('id<=' . $idfin)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents debut fn service 

    public function ReadHtmllisteAgentsparservicesetpardebutetfin($idservice, $iddebut, $idfin) {
        $service = Doctrine_Core::getTable('servicerh')->findOneById($idservice);
        $agdebut = Doctrine_Core::getTable('agents')->findOneById($iddebut);
        $agfin = Doctrine_Core::getTable('agents')->findOneById($idfin);
        $html = '<h3>Liste des Employés reliés au " ' . $service->getLibelle() . '" entre l\'employé "' . $agdebut->getNomcomplet() . " " . $agdebut->getPrenom() . '" ET "' . $agfin->getNomcomplet() . " " . $agfin->getPrenom() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>
                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s  ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id  ')
                ->andWhere('s.id= ?', $idservice)
                ->andWhere('id>=' . $iddebut)
                ->andWhere('id<=' . $idfin)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //agents par sous direction

    public function ReadHtmllisteAgentsparsousdirections($idsousdirection) {
        $directio = Doctrine_Core::getTable('sousdirection')->findOneById($idsousdirection);
        $html = ' <h3>Liste des Employés de la sous direction"' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s, sousdirection sd  ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id and  s.id_sousdirection=sd.id ')
                ->andWhere('sd.id= ?', $idsousdirection)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //agents debut et fin et sous direction 
    public function ReadHtmllisteAgentsparsousdirectionsetpardebutetfin($idsousdirection, $iddebut, $idfin) {
        $directio = Doctrine_Core::getTable('sousdirection')->findOneById($idsousdirection);
        $agdebut = Doctrine_Core::getTable('agents')->findOneById($iddebut);
        $agfin = Doctrine_Core::getTable('agents')->findOneById($idfin);

        $html = ' <h3>Liste des Employés reliés au sous direction"' . $directio->getLibelle() . '" entre l\'employé " ' . $agdebut->getNomcomplet() . " " . $agdebut->getPrenom() . '" ET " ' . $agfin->getNomcomplet() . " " . $agfin->getPrenom() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s, sousdirection sd  ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id and  s.id_sousdirection=sd.id ')
                ->andWhere('sd.id= ?', $idsousdirection)
                ->andWhere('id>=' . $iddebut)
                ->andWhere('id<=' . $idfin)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//par corps et cat

    public function ReadHtmllisteAgentsparcorpsetcat($id1, $id2) {
        $directio = Doctrine_Core::getTable('categorierh')->findOneById($id2);
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au catégorie "' . $directio->getLibelle() . '" et au corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, categorierh cat, corps cor')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_categorie=cat.id and s.id_corps=cor.id')
                ->andWhere('cat.id= ?', $id2)
                ->andWhere('cor.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et situation

    public function ReadHtmllisteAgentsparcorpsetsituation($id1, $id2) {
        $situation = Doctrine_Core::getTable('typecontrat')->findOneById($id2);
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $html = ' <h3>Liste des Employés ' . $situation->getLibelle() . ' reliés  au Corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c, salairedebase s,  corps cor,typecontrat ty')
                ->where('c.id_agents=a.id and c.id_typecontrat=ty.id and c.id_salairedebase=s.id and  s.id_corps=cor.id')
                ->andWhere('ty.id= ?', $id2)
                ->andWhere('cor.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et position 

    public function ReadHtmllisteAgentsparcorpsetposition($id1, $id2) {
        $situation = Doctrine_Core::getTable('positionadministratif')->findOneById($id2);
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $html = ' <h3>Liste des Employés ' . $situation->getLibelle() . ' reliés  au Corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c,  salairedebase s,  corps cor ,positionadministratif position ')
                ->where('c.id_agents=a.id and c.id_positionadmini=position.id and c.id_salairedebase=s.id and  s.id_corps=cor.id')
                ->andWhere('position.id= ?', $id2)
                ->andWhere('cor.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //cat et grade

    public function ReadHtmllisteAgentspargradeetcat($id1, $id2) {
        $directio = Doctrine_Core::getTable('categorierh')->findOneById($id2);
        $corps = Doctrine_Core::getTable('grade')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au catégorie "' . $directio->getLibelle() . '" et au grade "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, categorierh cat, grade gr')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_categorie=cat.id and s.id_grade=gr.id')
                ->andWhere('cat.id= ?', $id2)
                ->andWhere('gr.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et grade 

    public function ReadHtmllisteAgentsparcorpsetgrade($id1, $id2) {
        $directio = Doctrine_Core::getTable('corps')->findOneById($id1);
        $corps = Doctrine_Core::getTable('grade')->findOneById($id2);
        $html = ' <h3>Liste des Employés reliés  au catégorie "' . $directio->getLibelle() . '" et au grade "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_grade=g.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('g.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et lieu 

    public function ReadHtmllisteAgentsparcorpsetlieu($id1, $id2) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $lieu = Doctrine_Core::getTable('lieutravail')->findOneById($id2);
        $html = ' <h3>Liste des Employés ' . $lieu->getLibelle() . ' reliés  au Corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c,  salairedebase s,  corps cor , lieutravail lieu ')
                ->where('c.id_agents=a.id and c.id_lieu=lieu.id and c.id_salairedebase=s.id and  s.id_corps=cor.id')
                ->andWhere('lieu.id= ?', $id2)
                ->andWhere('cor.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et primes 

    public function ReadHtmllisteAgentsparcorpsetprime($id1, $id2) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $titresprime = Doctrine_Core::getTable('titreprimes')->findOneById($id2);

        $html = ' <h3>Liste des Employés qui ont les primes"' . $titresprime->getLibelle() . '" reliés  au Corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c,  salairedebase s,  corps cor , primes p, titreprimes titrep,ligneprimecontrat lignecp ')
                ->where('lignecp.id_contrat=c.id and lignecp.id_prime=p.id and  c.id_agents=a.id and p.id_titreprime=titrep.id and c.id_salairedebase=s.id and  s.id_corps=cor.id')
                ->andWhere('titrep.id= ?', $id2)
                ->andWhere('cor.id= ?', $id1)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et echelon

    public function ReadHtmllisteAgentsparcorpsetechelon($id1, $id2) {
        $directio = Doctrine_Core::getTable('echelon')->findOneById($id2);
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au echelon "' . $directio->getLibelle() . '" et au corps "' . $corps->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelon e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelon=e.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//echelle echelon

    public function ReadHtmllisteAgentsparechelleechelon($id1, $id2) {
        $directio = Doctrine_Core::getTable('echelon')->findOneById($id2);
        $e = Doctrine_Core::getTable('echelle')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au echelle "' . $e->getLibelle() . '" et au echelon "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s,echelon ech,echelle e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_echelon=ech.id and s.id_echelle=e.id')
                ->andWhere('e.id= ?', $id1)
                ->andWhere('ech.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//echelle ete categorie

    public function ReadHtmllisteAgentsparechellecat($id4, $id5) {
        $directio = Doctrine_Core::getTable('categorierh')->findOneById($id5);
        $e = Doctrine_Core::getTable('echelle')->findOneById($id4);
        $html = ' <h3>Liste des Employés reliés  au Catégorie "' . $directio->getLibelle() . '" et au Echelle "' . $e->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, echelle e ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id  and s.id_categorie=cat.id and s.id_echelle=e.id')
                ->andWhere('e.id= ?', $id4)
                ->andWhere('cat.id= ?', $id5)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//echelle grade

    public function ReadHtmllisteAgentsparechellegrade($id1, $id2) {
        $directio = Doctrine_Core::getTable('grade')->findOneById($id2);
        $e = Doctrine_Core::getTable('echelle')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au echelle "' . $e->getLibelle() . '" et au grade "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s,grade g,echelle e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_grade=g.id and s.id_echelle=e.id')
                ->andWhere('e.id= ?', $id1)
                ->andWhere('g.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//echelon cat 


    public function ReadHtmllisteAgentsparecheloncat($id1, $id2) {
        $directio = Doctrine_Core::getTable('categorierh')->findOneById($id2);
        $e = Doctrine_Core::getTable('echelon')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au Catégorie "' . $directio->getLibelle() . '" et au Echelon "' . $e->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, echelon e ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id  and s.id_categorie=cat.id and s.id_echelon=e.id')
                ->andWhere('e.id= ?', $id1)
                ->andWhere('cat.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//echelon grade 

    public function ReadHtmllisteAgentsparechelongrade($id1, $id2) {
        $directio = Doctrine_Core::getTable('grade')->findOneById($id2);
        $e = Doctrine_Core::getTable('echelon')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au Grade "' . $directio->getLibelle() . '" et au Echelon "' . $e->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, echelon e ,grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id  and s.id_grade=g.id and s.id_echelon=e.id')
                ->andWhere('e.id= ?', $id1)
                ->andWhere('g.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//cat grade

    public function ReadHtmllisteAgentsparcatgrade($id1, $id2) {
        $directio = Doctrine_Core::getTable('grade')->findOneById($id2);
        $e = Doctrine_Core::getTable('categorierh')->findOneById($id1);
        $html = ' <h3>Liste des Employés reliés  au Catégorie "' . $directio->getLibelle() . '" et au Echelon "' . $e->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s,grade g,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_grade=g.id and s.id_categorie=cat.id')
                ->andWhere('cat.id= ?', $id1)
                ->andWhere('g.id= ?', $id2)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps et echelle 

    public function ReadHtmllisteAgentsparcorpsetechelle($id3, $id4) {
        $directio = Doctrine_Core::getTable('echelle')->findOneById($id4);
        $corps = Doctrine_Core::getTable('corps')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés   au corps "' . $corps->getLibelle() . '"et au echelle "' . $directio->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id')
                ->andWhere('cor.id= ?', $id3)
                ->andWhere('e.id= ?', $id4)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //agents ar echelon ete chellle et corps

    public function ReadHtmllisteAgentsparcorpsetechelleetechelon($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '"et au echelon "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e ,echelon ech')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id and s.id_echelon=ech.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('ech.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //corps echelle categorie 

    public function ReadHtmllisteAgentsparcorpsetechelleetcat($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('categorierh')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '"et au Catégorie "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id and s.id_categorie=cat.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('cat.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    //corps echelon cat

    public function ReadHtmllisteAgentsparcorpsetechelonetcat($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelon')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('categorierh')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au Echelon "' . $echelle->getLibelle() . '"et au Catégorie "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelon e ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelon=e.id and s.id_categorie=cat.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('cat.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//cat echelon grade

    public function ReadHtmllisteAgentspargradeetechelonetcat($id1, $id2, $id3) {
        $grade = Doctrine_Core::getTable('grade')->findOneById($id1);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id2);
        $cat = Doctrine_Core::getTable('categorierh')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au Catégorie "' . $cat->getLibelle() . '" , au Echelon "' . $echelon->getLibelle() . '"et au Grade "' . $grade->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, grade g,echelon e ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_grade=g.id and s.id_echelon=e.id and s.id_categorie=cat.id')
                ->andWhere('g.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('cat.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps grade cat

    public function ReadHtmllisteAgentsparcorpsetegradeetcat($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('grade')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('categorierh')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au Catégorie "' . $echelon->getLibelle() . '"et au Grade "' . $echelle->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,grade g ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_grade=g.id and s.id_categorie=cat.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('g.id= ?', $id2)
                ->andWhere('cat.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps echelle grade 
    public function ReadHtmllisteAgentsparcorpsetechelleetgrade($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('grade')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '"et au Grade "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e ,grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id and s.id_grade=g.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('g.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//corps echelon gade

    public function ReadHtmllisteAgentsparcorpsetechelonetgrade($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelon')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('grade')->findOneById($id3);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au Echelon "' . $echelle->getLibelle() . '"et au Grade "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelon e ,grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelon=e.id and s.id_grade=g.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('g.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

// echelon echelle cat corps 

    public function ReadHtmllisteAgentsparcorpsetechelleetechelonetcat($id1, $id2, $id3, $id4) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id3);
        $cat = Doctrine_Core::getTable('categorierh')->findOneById($id4);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '", au echelon "' . $echelon->getLibelle() . '"et au catégorie "' . $cat->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e ,echelon ech ,categorierh cat')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id and s.id_echelon=ech.id and s.id_categorie=cat.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('ech.id= ?', $id3)
                ->andWhere('cat.id= ?', $id4)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//cat echelon echellle 
    public function ReadHtmllisteAgentsparcatetechelleetechelon($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('categorierh')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id3);

        $html = ' <h3>Liste des Employés reliés  au Catégorie "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '"et  au echelon "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, categorierh cat,echelle e ,echelon ech')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_categorie=cat.id and s.id_echelle=e.id and s.id_echelon=ech.id')
                ->andWhere('cat.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('ech.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//cat echelle echelon


    public function ReadHtmllisteAgentspargradeetechelleetechelon($id1, $id2, $id3) {
        $corps = Doctrine_Core::getTable('grade')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id3);

        $html = ' <h3>Liste des Employés reliés  au Grade "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '"et  au echelon "' . $echelon->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, grade g,echelle e ,echelon ech')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_grade=g.id and s.id_echelle=e.id and s.id_echelon=ech.id')
                ->andWhere('g.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('ech.id= ?', $id3)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    // echelon echelle cat corps  grade

    public function ReadHtmllisteAgentsparcorpsetechelleetechelonetcatgrade($id1, $id2, $id3, $id4, $id5) {
        $corps = Doctrine_Core::getTable('corps')->findOneById($id1);
        $echelle = Doctrine_Core::getTable('echelle')->findOneById($id2);
        $echelon = Doctrine_Core::getTable('echelon')->findOneById($id3);
        $cat = Doctrine_Core::getTable('categorierh')->findOneById($id4);
        $grade = Doctrine_Core::getTable('grade')->findOneById($id5);
        $html = ' <h3>Liste des Employés reliés  au corps "' . $corps->getLibelle() . '" , au echelle "' . $echelle->getLibelle() . '", au echelon "' . $echelon->getLibelle() . '", au catégorie "' . $cat->getLibelle() . '"et au grade "' . $grade->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>NomComplet</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , salairedebase s, corps cor,echelle e ,echelon ech ,categorierh cat,grade g')
                ->where('c.id_agents=a.id and c.id_salairedebase=s.id and s.id_corps=cor.id and s.id_echelle=e.id and s.id_echelon=ech.id and s.id_categorie=cat.id and s.id_grade=g.id')
                ->andWhere('cor.id= ?', $id1)
                ->andWhere('e.id= ?', $id2)
                ->andWhere('ech.id= ?', $id3)
                ->andWhere('cat.id= ?', $id4)
                ->andWhere('g.id= ?', $id5)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

//agents par service 

    public function ReadHtmllisteAgentsparservice($ids) {
        $service = Doctrine_Core::getTable('servicerh')->findOneById($ids);
        $html = ' <h3>Liste des Employés reliés au "' . $service->getLibelle() . '"</h3>
            <table border="1" style="padding:1%">
                <tbody>

                    <tr><td style="width: 10%;"><label>Numéro</label></td>
                        <td style="width: 30%;"><label>Matricule</label></td>
                        <td style="width: 40%;"><label>Agent</label></td>
                        <td style="width: 20%;"><label>CIN</label></td>
                        </tr>
                        ';

        $documentagents = Doctrine_Core::getTable('agents')
                ->createQuery('a')
                ->select('*')
                ->from('agents a,contrat c , posterh p ,unite u , servicerh s  ')
                ->where('c.id_agents=id and c.id_posterh=p.id and p.id_unite=u.id and u.id_service=s.id  ')
                ->andWhere('s.id= ?', $ids)
                ->execute();
        $i = 1;
        foreach ($documentagents as $p):
            $html.= '<tr>'
                    . '<td>' . $i . '</td>'
                    . '<td>' . $p->getIdrh()
                    . '</td>' . '<td>' . $p->getNomComplet() . " " . $p->getPrenom() . '</td>' . '<td>' . $p->getCin() . '</td></tr>';
            $i++;
        endforeach;
        $html.='<tbody></table>';
        return $html;
    }

    public function __toString() {
        return $this->getIdrh() . " " . $this->getNomcomplet() . " " . $this->getPrenom() . "  ";
    }

    public function getidagents() {
        return $this->getId();
    }

    public function getMatricule($id) {
        return $this->getIdrh();
    }

    public function getNumeroseqfiche() {
        $doc = Doctrine_Query::create()
                        ->select('COALESCE(MAX(a.id),0) as id')
                        ->from('agents a')->execute();

        return sprintf('%06d', $doc[0]['id'] + 1);
    }

    public function getnaissance() {
        return $this->getDatenaissance();
    }

    public function getIdBureaux() {
        $user = Doctrine_Core::getTable('utilisateur')->findOneByIdParent($this->getId());
        $usertest = new Utilisateur();
        $usertest = $user;
        $contrat = new Contrat();
        $contrats = $usertest->getAgents()->getContrat();
        $contrat = $contrats[count($contrats) - 1];
        return $contrat->getIdBureaux();
    }

    public function getPoste() {
        $contrat = new Contrat();
        $contrats = $this->getContrat();
        $contrat = $contrats[count($contrats) - 1];
        return $contrat->getPoste();
    }

    public function getAge() {
        $time = date('d-m-Y', strtotime(date('d-m-Y', strtotime($this->getDatenaissance()))));
        $_age = floor((time() - strtotime($time)) / 31556926);
        return $_age;
    }

    public function ReadHtmlFicheAgent($id) {
        $agent = AgentsTable::getInstance()->find($id);
        $html = ' <h3 style="font-size:18px;">Fiche Agent : ' . $agent->getNomcomplet() . ' ' . $agent->getPrenom() . '</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Données de Base</i></h4>
            &nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Données de Base</h4><hr width="96%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 16%; height: 25px;"><b>Matricule :</b></td>
                                    <td style="width: 34%;">' . $agent->getIdrh() . '</td>
                                    <td style="width: 15%;"><b>C.I.N :</b></td>
                                    <td style="width: 35%;">' . $agent->getCin() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 25px;"><b>Nom :</b></td>
                                    <td style="width: 40%;">' . $agent->getNomcomplet() . '</td>
                                    <td style="width: 15%;"><b>Prénom :</b></td>
                                    <td style="width: 35%;">' . $agent->getPrenom() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Date Naissance :</b></td>
                                    <td style="width: 56%;">' . $agent->getDatenaissance() . '</td>
                                    <td style="width: 9%;"><b>Age :</b></td>
                                    <td style="width: 10%;">' . $agent->getAge() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Lieu Naissance :</b></td>
                                    <td style="width: 55%;">' . $agent->getGouvernera_10() . '</td>
                                    <td style="width: 10%;"><b>Sexe :</b></td>
                                    <td style="width: 10%;">' . $agent->getSexe() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 15%; height: 25px;"><b>Adresse :</b></td>
                                    <td style="width: 51%;">' . $agent->getAdresse() . '</td>
                                    <td style="width: 24%;"><b>Regroupement :</b></td>
                                    <td style="width: 10%;">' . $agent->getRegroupementagents() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 20px;"><b>Ville :</b></td>
                                    <td style="width: 51%;">' . $agent->getGouvernera() . '</td>
                                    <td style="width: 29%;"><b>Situation Familiale :</b></td>
                                    <td style="width: 10%;">' . $agent->getEtatcivil() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>&nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Informations Supplémentaires</h4><hr width="95%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 30%; height: 45px;"><b>Identifiant Carte Professionnelle :</b></td>
                                    <td style="width: 35%;">' . $agent->getIdpersonnel() . '</td>
                                    <td style="width: 18%;"><b>Etat militaire :</b></td>
                                    <td style="width: 17%;">' . $agent->getEtatmulitaire() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Code Postal :</b></td>
                                    <td style="width: 40%;">' . $agent->getCodepostal() . '</td>
                                    <td style="width: 13%;"><b>Pays :</b></td>
                                    <td style="width: 17%;">' . $agent->getPays() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 25px;"><b>GSM :</b></td>
                                    <td style="width: 25%;">' . $agent->getGsm() . '</td>
                                    <td style="width: 48%;"><b>Identifiant unique (CNRPS) :</b></td>
                                    <td style="width: 17%;">' . $agent->getIdcnss() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 28%; height: 25px;"><b>Date d\'affiliation :</b></td>
                                    <td style="width: 27%;">' . $agent->getDateaffiliation() . '</td>
                                    <td style="width: 10%;"><b>RIP/B :</b></td>
                                    <td style="width: 35%;">' . $agent->getRib() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 26%; height: 25px;"><b>Niveau Scolaire :</b></td>
                                    <td style="width: 29%;">' . $agent->getNiveaueducatif() . '</td>
                                    <td style="width: 23%;"><b>Chef Famille :</b></td>
                                    <td style="width: 22%;">' . $agent->getCheffamille() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 31%; height: 20px;"><b>Nombres d\'enfants :</b></td>
                                    <td style="width: 69%;">' . $agent->getNbrenfants() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>';

        $html.='<h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Informations Educatives</i></h4>
                <h5 style="font-size:4px;">&nbsp;</h5>
                <h4><i>Liste des Diplômes :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:53%;"><b>Diplôme</b></td>
                        <td style="width:15%;text-align:center;"><b>Année</b></td>
                        <td style="width:25%;text-align:center;"><b>Mention</b></td>
                    </tr>';
        $lignedipagents = $agent->getLignedipagents();
        if ($lignedipagents->count() != 0):
            foreach ($lignedipagents as $lignedipagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignedipagent->getNordre() . '</td>
                        <td>' . $lignedipagent->getDiplome()->getLibelle() . '</td>
                        <td style="text-align:center;">' . $lignedipagent->getAnnee() . '</td>
                        <td style="text-align:center;">' . $lignedipagent->getLibelle() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de diplômes</td>
                    </tr>';
        endif;

        $html.='</table>
                <h4><i>Liste des Spécialités :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Spécialité</b></td>
                        <td style="width:45%;"><b>Description</b></td>
                    </tr>';
        $lignespecialteagents = $agent->getLignespecialteagents();
        if ($lignespecialteagents->count() != 0):
            foreach ($lignespecialteagents as $lignespecialteagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignespecialteagent->getNordre() . '</td>
                        <td>' . $lignespecialteagent->getSpecialite()->getLibelle() . '</td>
                        <td>' . $lignespecialteagent->getDescription() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de spécialités</td>
                    </tr>';
        endif;
        $html.='</table>
                <h4><i>Liste des Langues :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Langue</b></td>
                        <td style="width:45%;"><b>Description</b></td>
                    </tr>';
        $lignelangueagents = $agent->getLignelangueagents();
        if ($lignelangueagents->count() != 0):
            foreach ($lignelangueagents as $lignelangueagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignelangueagent->getNordre() . '</td>
                        <td>' . $lignelangueagent->getLangues()->getLibelle() . '</td>
                        <td>' . $lignelangueagent->getDescription() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de langues</td>
                    </tr>';
        endif;
        $html.='</table>        
                <h4><i>Formation Continue :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:27%;"><b>Description</b></td>
                        <td style="width:27%;"><b>Organistaion</b></td>
                        <td style="width:12%;"><b>Durée</b></td>
                        <td style="width:14%;"><b>Date</b></td>
                        <td style="width:15%;"><b>Type</b></td>
                    </tr>';
        $experiences = $agent->getExperiences();
        if ($experiences->count() != 0):
            foreach ($experiences as $experience):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $experience->getNordre() . '</td>
                        <td>' . $experience->getDescription() . '</td>
                        <td>' . $experience->getOrganistaion() . '</td>
                        <td>' . $experience->getDuree() . '</td>
                        <td>' . $experience->getDate() . '</td>
                        <td>' . $experience->getTypeexperience()->getLibelle() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de formations</td>
                    </tr>';
        endif;
        $html.='</table>&nbsp;<br>';

        $html.='<h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Informations Sociales</i></h4>
                <h5 style="font-size:4px;">&nbsp;</h5>
                <h4><i>Conjoint :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Nom & Prénom</b></td>
                        <td style="width:45%;"><b>Etat de travail</b></td>
                    </tr>';
        $conjoints = $agent->getConjoints();
        $array_travail = $array = array("0" => "Ne travaille pas", "1" => "Travaille");
        if ($conjoints->count() != 0):
            foreach ($conjoints as $conjoint):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $conjoint->getNordre() . '</td>
                        <td>' . $conjoint->getNom() . ' ' . $conjoint->getPrenom() . '</td>
                        <td>' . $array_travail[intval($conjoint->getEtattravail())] . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de conjoint</td>
                    </tr>';
        endif;
        $html.='</table>';
        $html.='<h4><i>Liste des Enfants en Charge :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:32%;"><b>Nom</b></td>
                        <td style="width:32%;"><b>Prénom</b></td>
                        <td style="width:19%;text-align:center;"><b>Date Naissance</b></td>
                        <td style="width:12%;text-align:center;"><b>Age</b></td>
                    </tr>';
        $enfants = $agent->getEnfants();
        if ($enfants->count() != 0):
            foreach ($enfants as $enfant):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $enfant->getNordre() . '</td>
                        <td>' . $enfant->getNom() . '</td>
                        <td>' . $enfant->getPrenom() . '</td>
                        <td style="text-align:center;">' . $enfant->getDatenaissance() . '</td>
                        <td style="text-align:center;">' . $enfant->getDatemajeur() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas d\'enfants en charge</td>
                    </tr>';
        endif;
        $html.='</table>';
        $html.='<h4><i>Liste des Parents en Charge :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:38%;"><b>Nom</b></td>
                        <td style="width:38%;"><b>Prénom</b></td>
                        <td style="width:19%;text-align:center;"><b>Date Naissance</b></td>
                    </tr>';
        $parents = $agent->getParents();
        if ($parents->count() != 0):
            foreach ($parents as $parent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $parent->getNordre() . '</td>
                        <td>' . $parent->getNom() . '</td>
                        <td>' . $parent->getPrenom() . '</td>
                        <td style="text-align:center;">' . $parent->getDatenaissance() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de parents en charge</td>
                    </tr>';
        endif;
        $html.='</table>';

        return $html;
    }

    public function ReadHtmlFicheAgentDonneeBase($id) {
        $agent = AgentsTable::getInstance()->find($id);
        $html = ' <h3 style="font-size:18px;">Données de Base <br>Agent : ' . $agent->getNomcomplet() . ' ' . $agent->getPrenom() . '</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Données de Base</i></h4>
            &nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Données de Base</h4><hr width="96%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 16%; height: 25px;"><b>Matricule :</b></td>
                                    <td style="width: 34%;">' . $agent->getIdrh() . '</td>
                                    <td style="width: 15%;"><b>C.I.N :</b></td>
                                    <td style="width: 35%;">' . $agent->getCin() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 25px;"><b>Nom :</b></td>
                                    <td style="width: 40%;">' . $agent->getNomcomplet() . '</td>
                                    <td style="width: 15%;"><b>Prénom :</b></td>
                                    <td style="width: 35%;">' . $agent->getPrenom() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Date Naissance :</b></td>
                                    <td style="width: 56%;">' . $agent->getDatenaissance() . '</td>
                                    <td style="width: 9%;"><b>Age :</b></td>
                                    <td style="width: 10%;">' . $agent->getAge() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Lieu Naissance :</b></td>
                                    <td style="width: 55%;">' . $agent->getGouvernera_10() . '</td>
                                    <td style="width: 10%;"><b>Sexe :</b></td>
                                    <td style="width: 10%;">' . $agent->getSexe() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 15%; height: 25px;"><b>Adresse :</b></td>
                                    <td style="width: 51%;">' . $agent->getAdresse() . '</td>
                                    <td style="width: 24%;"><b>Regroupement :</b></td>
                                    <td style="width: 10%;">' . $agent->getRegroupementagents() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 20px;"><b>Ville :</b></td>
                                    <td style="width: 51%;">' . $agent->getGouvernera() . '</td>
                                    <td style="width: 29%;"><b>Situation Familiale :</b></td>
                                    <td style="width: 10%;">' . $agent->getEtatcivil() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>&nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Informations Supplémentaires</h4><hr width="95%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 30%; height: 45px;"><b>Identifiant Carte Professionnelle :</b></td>
                                    <td style="width: 35%;">' . $agent->getIdpersonnel() . '</td>
                                    <td style="width: 18%;"><b>Etat militaire :</b></td>
                                    <td style="width: 17%;">' . $agent->getEtatmulitaire() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 25%; height: 25px;"><b>Code Postal :</b></td>
                                    <td style="width: 40%;">' . $agent->getCodepostal() . '</td>
                                    <td style="width: 13%;"><b>Pays :</b></td>
                                    <td style="width: 17%;">' . $agent->getPays() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 25px;"><b>GSM :</b></td>
                                    <td style="width: 25%;">' . $agent->getGsm() . '</td>
                                    <td style="width: 48%;"><b>Identifiant unique (CNRPS) :</b></td>
                                    <td style="width: 17%;">' . $agent->getIdcnss() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 28%; height: 25px;"><b>Date d\'affiliation :</b></td>
                                    <td style="width: 27%;">' . $agent->getDateaffiliation() . '</td>
                                    <td style="width: 10%;"><b>RIP/B :</b></td>
                                    <td style="width: 35%;">' . $agent->getRib() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 26%; height: 25px;"><b>Niveau Scolaire :</b></td>
                                    <td style="width: 29%;">' . $agent->getNiveaueducatif() . '</td>
                                    <td style="width: 23%;"><b>Chef Famille :</b></td>
                                    <td style="width: 22%;">' . $agent->getCheffamille() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 31%; height: 20px;"><b>Nombres d\'enfants :</b></td>
                                    <td style="width: 69%;">' . $agent->getNbrenfants() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>';

        return $html;
    }

    public function ReadHtmlFicheAgentEducative($id) {
        $agent = AgentsTable::getInstance()->find($id);
        $html = ' <h3 style="font-size:18px;">Informations Educatives<br>Agent : ' . $agent->getNomcomplet() . ' ' . $agent->getPrenom() . '</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Données de Base</i></h4>
            &nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Données de Base</h4><hr width="96%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 16%; height: 25px;"><b>Matricule :</b></td>
                                    <td style="width: 34%;">' . $agent->getIdrh() . '</td>
                                    <td style="width: 15%;"><b>C.I.N :</b></td>
                                    <td style="width: 35%;">' . $agent->getCin() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 20px;"><b>Nom :</b></td>
                                    <td style="width: 40%;">' . $agent->getNomcomplet() . '</td>
                                    <td style="width: 15%;"><b>Prénom :</b></td>
                                    <td style="width: 35%;">' . $agent->getPrenom() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>';

        $html.='<h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Informations Educatives</i></h4>
                <h5 style="font-size:4px;">&nbsp;</h5>
                <h4><i>Liste des Diplômes :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:53%;"><b>Diplôme</b></td>
                        <td style="width:15%;text-align:center;"><b>Année</b></td>
                        <td style="width:25%;text-align:center;"><b>Mention</b></td>
                    </tr>';
        $lignedipagents = $agent->getLignedipagents();
        if ($lignedipagents->count() != 0):
            foreach ($lignedipagents as $lignedipagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignedipagent->getNordre() . '</td>
                        <td>' . $lignedipagent->getDiplome()->getLibelle() . '</td>
                        <td style="text-align:center;">' . $lignedipagent->getAnnee() . '</td>
                        <td style="text-align:center;">' . $lignedipagent->getLibelle() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de diplômes</td>
                    </tr>';
        endif;

        $html.='</table>
                <h4><i>Liste des Spécialités :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Spécialité</b></td>
                        <td style="width:45%;"><b>Description</b></td>
                    </tr>';
        $lignespecialteagents = $agent->getLignespecialteagents();
        if ($lignespecialteagents->count() != 0):
            foreach ($lignespecialteagents as $lignespecialteagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignespecialteagent->getNordre() . '</td>
                        <td>' . $lignespecialteagent->getSpecialite()->getLibelle() . '</td>
                        <td>' . $lignespecialteagent->getDescription() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de spécialités</td>
                    </tr>';
        endif;
        $html.='</table>
                <h4><i>Liste des Langues :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Langue</b></td>
                        <td style="width:45%;"><b>Description</b></td>
                    </tr>';
        $lignelangueagents = $agent->getLignelangueagents();
        if ($lignelangueagents->count() != 0):
            foreach ($lignelangueagents as $lignelangueagent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $lignelangueagent->getNordre() . '</td>
                        <td>' . $lignelangueagent->getLangues()->getLibelle() . '</td>
                        <td>' . $lignelangueagent->getDescription() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de langues</td>
                    </tr>';
        endif;
        $html.='</table>        
                <h4><i>Formation Continue :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:27%;"><b>Description</b></td>
                        <td style="width:27%;"><b>Organistaion</b></td>
                        <td style="width:12%;"><b>Durée</b></td>
                        <td style="width:14%;"><b>Date</b></td>
                        <td style="width:15%;"><b>Type</b></td>
                    </tr>';
        $experiences = $agent->getExperiences();
        if ($experiences->count() != 0):
            foreach ($experiences as $experience):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $experience->getNordre() . '</td>
                        <td>' . $experience->getDescription() . '</td>
                        <td>' . $experience->getOrganistaion() . '</td>
                        <td>' . $experience->getDuree() . '</td>
                        <td>' . $experience->getDate() . '</td>
                        <td>' . $experience->getTypeexperience()->getLibelle() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de formations</td>
                    </tr>';
        endif;
        $html.='</table>';

        return $html;
    }

    public function ReadHtmlFicheAgentSociale($id) {
        $agent = AgentsTable::getInstance()->find($id);
        $html = ' <h3 style="font-size:18px;">Informations Sociales<br>Agent : ' . $agent->getNomcomplet() . ' ' . $agent->getPrenom() . '</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Données de Base</i></h4>
            &nbsp;<br>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Données de Base</h4><hr width="96%"></td>
                        <td style="width: 80%;">
                            <table boder="1">
                                <tr>
                                    <td style="width: 16%; height: 25px;"><b>Matricule :</b></td>
                                    <td style="width: 34%;">' . $agent->getIdrh() . '</td>
                                    <td style="width: 15%;"><b>C.I.N :</b></td>
                                    <td style="width: 35%;">' . $agent->getCin() . '</td>
                                </tr>
                                <tr>
                                    <td style="width: 10%; height: 20px;"><b>Nom :</b></td>
                                    <td style="width: 40%;">' . $agent->getNomcomplet() . '</td>
                                    <td style="width: 15%;"><b>Prénom :</b></td>
                                    <td style="width: 35%;">' . $agent->getPrenom() . '</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                <tbody>
            </table>&nbsp;<br>';

        $html.='<h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Informations Sociales</i></h4>
                <h5 style="font-size:4px;">&nbsp;</h5>
                <h4><i>Conjoint :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:7%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:48%;"><b>Nom & Prénom</b></td>
                        <td style="width:45%;"><b>Etat de travail</b></td>
                    </tr>';
        $conjoints = $agent->getConjoints();
        $array_travail = $array = array("0" => "Ne travaille pas", "1" => "Travaille");
        if ($conjoints->count() != 0):
            foreach ($conjoints as $conjoint):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $conjoint->getNordre() . '</td>
                        <td>' . $conjoint->getNom() . ' ' . $conjoint->getPrenom() . '</td>
                        <td>' . $array_travail[intval($conjoint->getEtattravail())] . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de conjoint</td>
                    </tr>';
        endif;
        $html.='</table>';
        $html.='<h4><i>Liste des Enfants en Charge :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:32%;"><b>Nom</b></td>
                        <td style="width:32%;"><b>Prénom</b></td>
                        <td style="width:19%;text-align:center;"><b>Date Naissance</b></td>
                        <td style="width:12%;text-align:center;"><b>Age</b></td>
                    </tr>';
        $enfants = $agent->getEnfants();
        if ($enfants->count() != 0):
            foreach ($enfants as $enfant):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $enfant->getNordre() . '</td>
                        <td>' . $enfant->getNom() . '</td>
                        <td>' . $enfant->getPrenom() . '</td>
                        <td style="text-align:center;">' . $enfant->getDatenaissance() . '</td>
                        <td style="text-align:center;">' . $enfant->getDatemajeur() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas d\'enfants en charge</td>
                    </tr>';
        endif;
        $html.='</table>';
        $html.='<h4><i>Liste des Parents en Charge :</i></h4>
                <table border="1" cellspace="0" cellpadding="3">
                    <tr style="background-color:#ECECEC;">
                        <td style="width:5%;height:25px;text-align:center;"><b>N°</b></td>
                        <td style="width:38%;"><b>Nom</b></td>
                        <td style="width:38%;"><b>Prénom</b></td>
                        <td style="width:19%;text-align:center;"><b>Date Naissance</b></td>
                    </tr>';
        $parents = $agent->getParents();
        if ($parents->count() != 0):
            foreach ($parents as $parent):
                $html.='<tr>
                        <td style="height:20px;text-align:center;">' . $parent->getNordre() . '</td>
                        <td>' . $parent->getNom() . '</td>
                        <td>' . $parent->getPrenom() . '</td>
                        <td style="text-align:center;">' . $parent->getDatenaissance() . '</td>
                    </tr>';
            endforeach;
        else:
            $html.='<tr>
                        <td style="width:100%;height:20px;text-align:center;">Pas de parents en charge</td>
                    </tr>';
        endif;
        $html.='</table>';

        return $html;
    }

    public function ReadHtmlFichePersonnelleAvecChoix(sfWebRequest $request) {
        $id = $request->getParameter('id');
        $cin = $request->getParameter('cin');
        $idrh = $request->getParameter('idrh');
        $nbrenfant = $request->getParameter('nbrenfant');
        $chef = $request->getParameter('chef');
        $niveauscolaire = $request->getParameter('niveauscolaire');
        $rib = $request->getParameter('rib');
        $dateaff = $request->getParameter('dateaff');
        $idcnss = $request->getParameter('idcnss');
        $gsm = $request->getParameter('gsm');
        $paye = $request->getParameter('paye');
        $ville = $request->getParameter('ville');
        $codep = $request->getParameter('codep');
        $etat = $request->getParameter('etat');
        $idcarte = $request->getParameter('idcarte');
        $situation = $request->getParameter('situation');
        $reg = $request->getParameter('reg');
        $adresse = $request->getParameter('adresse');
        $sexe = $request->getParameter('sexe');
        $lieun = $request->getParameter('lieun');
        $daten = $request->getParameter('daten');
        $prenom = $request->getParameter('prenom');
        $nom = $request->getParameter('nom');
        $age = $request->getParameter('age');

        $agent = AgentsTable::getInstance()->find($id);
        $date_naissance = '';
        if ($agent->getDatenaissance())
            $date_naissance = date('d/m/Y', strtotime($agent->getDatenaissance()));

        $date_affiliation = '';
        if ($agent->getDateaffiliation())
            $date_affiliation = date('d/m/Y', strtotime($agent->getDateaffiliation()));

        $html = '<h3 style="font-size:18px;">Fiche Agent<br>' . $agent->getNomcomplet() . ' ' . $agent->getPrenom() . '</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <h4 border="1" style="text-align:center;background-color:#DCDCDC;"><i>Données de Base</i></h4>
            &nbsp;<br>';
        if ($idrh != "" || $cin != "" || $nom != "" || $prenom != "" || $daten != "" || $age != "" || $lieun != "" || $sexe != "" || $adresse != "" || $reg != "" || $ville != "" || $situation != "") {
            $html.='<table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Données de Base</h4><hr width="96%"></td>
                        <td style="width: 80%;">
                            <table boder="1">';
            if ($idrh != "" || $cin != "") {
                $html.='<tr>';
                if ($idrh != ""):
                    $html .= '<td style="width: 20%; height: 25px;"><b>Matricule :</b></td>
                                    <td style="width: 20%;">' . $agent->getIdrh() . '</td>';
                endif;
                if ($cin != ""):
                    $html .= ' <td style="width: 20%; height: 25px;"><b>C.I.N :</b></td>
                     <td style="width: 35%;">' . $agent->getCin() . '</td>';
                endif;
                $html .= '</tr>';
            }
            if ($nom != "" || $prenom != "") {
                $html .= '<tr>';
                if ($nom != ""):
                    $html .='   <td style="width: 20%; height: 25px;"><b>Nom :</b></td>
                                    <td style="width: 20%;">' . $agent->getNomcomplet() . '</td>';
                endif;
                if ($prenom != ""):
                    $html .= '<td style="width: 20%; height: 25px;"><b>Prénom :</b></td>
                    <td style="width: 20%;">' . $agent->getPrenom() . '</td>';
                endif;
                $html .= '</tr>';
            }
            if ($daten != "" || $age != "") {
                $html .= '<tr>';
                if ($daten != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Date Naissance :</b></td>
                    <td style="width: 20%;">' . $date_naissance . '</td>';
                endif;
                if ($age != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Age :</b></td>
                    <td style="width: 20%;">' . $agent->getAge() . '</td>';
                endif;
                $html.= '</tr>';
            }
            if ($lieun != "" || $sexe != "") {
                $html.= '<tr>';
                if ($lieun != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Lieu Naissance :</b></td>
                    <td style="width: 20%;">' . $agent->getGouvernera_10() . '</td>';
                endif;
                if ($sexe != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Sexe :</b></td>
                            <td style="width: 20%;">' . $agent->getSexe() . '</td>';
                endif;
                $html.='</tr>';
            }
            if ($adresse != "" || $reg != "") {
                $html.= '<tr>';
                if ($adresse != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Adresse :</b></td>
                    <td style="width: 20%;">' . $agent->getAdresse() . '</td>';
                endif;
                if ($reg != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Regroupement :</b></td>
                    <td style="width: 20%;">' . $agent->getRegroupementagents() . '</td>';
                endif;
                $html.='</tr>';
            }
            if ($ville != "" || $situation != "") {
                $html.= '<tr>';
                if ($ville != ""):
                    $html .='<td style="width: 20%; height: 20px;"><b>Ville :</b></td>
                    <td style="width: 20%;">' . $agent->getGouvernera() . '</td>';
                endif;

                if ($situation != ""):
                    $html .='<td style="width: 20%; height: 20px;"><b>Situation Familiale :</b></td>
                                    <td style="width: 20%;">' . $agent->getEtatcivil() . '</td>';
                endif;
                $html.='</tr>';
            }
            $html.= '</table></td></tr></tbody></table> &nbsp;<br>&nbsp;<br>';
        }

        if ($idcarte != "" || $etat != "" || $codep != "" || $paye != "" || $gsm != "" || $idcnss != "" || $dateaff != "" || $rib != "" || $niveauscolaire != "" || $chef != "" || $nbrenfant != "") {
            $html .='<table>
                <tbody>
                    <tr>
                        <td style="width: 20%; border-right: 1px solide #000;"><h4>Informations Supplémentaires</h4><hr width="95%"></td>
                        <td style="width: 80%;">
                            <table boder="1">';

            if ($idcarte != "" || $etat != "") {
                $html .='<tr>';
                if ($idcarte != ""):
                    $html .=' <td style="width: 20%; height: 45px;"><b>Id.Carte Professionnelle :</b></td>
                      <td style="width: 20%;">' . $agent->getIdpersonnel() . '</td>';
                endif;
                if ($etat != ""):
                    $html .=' <td style="width: 20%; height: 25px;"><b>Etat militaire :</b></td>
                     <td style="width: 20%;">' . $agent->getEtatmulitaire() . '</td>';
                endif;
                $html .='</tr>';
            }
            if ($codep != "" || $paye != "") {
                $html .='<tr>';
                if ($codep != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Code Postal :</b></td>
                  <td style="width: 20%;">' . $agent->getCodepostal() . '</td>';
                endif;
                if ($paye != ""):
                    $html .='  <td style="width: 20%; height: 25px;"><b>Pays :</b></td>
                        <td style="width: 20%;">' . $agent->getPays() . '</td>';
                endif;
                $html .='</tr>';
            }
            if ($gsm != "" || $idcnss != "") {
                $html .='<tr>';
                if ($gsm != ""):
                    $html .=' <td style="width: 20%; height: 25px;"><b>GSM :</b></td>
                     <td style="width: 20%;">' . $agent->getGsm() . '</td>';
                endif;
                if ($idcnss != ""):
                    $html .='<td style="width: 20%; height: 45px;"><b>Identifiant unique(CNRPS) :</b></td>
                    <td style="width: 20%;">' . $agent->getIdcnss() . '</td>';
                endif;
                $html .='</tr>';
            }
            if ($dateaff != "" || $rib != "") {
                $html .='<tr>';
                if ($dateaff != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Date d\'affiliation :</b></td>
                    <td style="width: 20%;">' . $date_affiliation . '</td>';
                endif;
                if ($rib != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>RIP/B :</b></td>
                    <td style="width: 20%;">' . $agent->getRib() . '</td>';
                endif;
                $html .='</tr>';
            }
            if ($niveauscolaire != "" || $chef != "") {
                $html .='<tr>';
                if ($niveauscolaire != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Niveau Scolaire :</b></td>
                    <td style="width: 20%;">' . $agent->getNiveaueducatif() . '</td>';
                endif;
                if ($chef != ""):
                    $html .='<td style="width: 20%; height: 25px;"><b>Chef Famille :</b></td>
                    <td style="width: 20%;">' . $agent->getCheffamille() . '</td>';
                endif;
                $html .='</tr>';
            }
            if ($nbrenfant != "") {
                $html .='<tr>';
                $html .='<td style="width: 20%; height: 20px;"><b>Nombres d\'enfants :</b></td>
                    <td style="width: 20%;">' . $agent->getNbrenfants() . '</td>';
                $html .='</tr>';
            }
            $html .='</table></td></tr></tbody></table>';
        }

        return $html;
    }

    public function ReadHtmlListePersonnelleAvecChoix(sfWebRequest $request) {
        $idrh_filtre = $request->getParameter('idrh_filtre');
        $cin_filtre = $request->getParameter('cin_filtre');
//        $prenom_filtre = $request->getParameter('prenom_filtre');
//        $id_regroupement = $request->getParameter('id_regroupement');
//
//        if ($id_regroupement != '' && $id_regroupement != '0')
//            $regroupement = RegroupementagentsTable::getInstance()->find($id_regroupement);
//        else
//            $regroupement = 'Tous';

        $cin = $request->getParameter('cin', '');
        $idrh = $request->getParameter('idrh', '');
        $nbrenfant = $request->getParameter('nbrenfant', '');
        $chef = $request->getParameter('chef', '');
        $niveauscolaire = $request->getParameter('niveauscolaire', '');
        $rib = $request->getParameter('rib', '');
        $dateaff = $request->getParameter('dateaff', '');
        $idcnss = $request->getParameter('idcnss', '');
        $gsm = $request->getParameter('gsm', '');
        $paye = $request->getParameter('paye', '');
        $ville = $request->getParameter('ville', '');
        $codep = $request->getParameter('codep', '');
        $etat = $request->getParameter('etat', '');
        $idcarte = $request->getParameter('idcarte', '');
        $situation = $request->getParameter('situation', '');
        $reg = $request->getParameter('reg', '');
        $adresse = $request->getParameter('adresse', '');
        $sexe = $request->getParameter('sexe', '');
        $lieun = $request->getParameter('lieun', '');
        $daten = $request->getParameter('daten', '');
        $prenom = $request->getParameter('prenom', '');
        $nom = $request->getParameter('nom', '');
        $age = $request->getParameter('age', '');

        $html = '<h3 style="font-size:18px;">Liste des Personnels</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            <div border="1">
                <table>
                    <tr>
                    
                        <td><b>Matricule :</b> ' . $idrh_filtre . '</td>
                        <td><b>Cin :</b> ' . cin_filtre . '</td>';
//                        <td><b>Prénom :</b> ' . $prenom_filtre . '</td>
//                        <td><b>Regroupement :</b> ' . $regroupement . '</td>
        $html.='  </tr>
                </table>
            </div>
            &nbsp;<br>';

        $liste = AgentsTable::getInstance()->getForPersonnalPrintAccueil($idrh_filtre,$cin_filtre);

        $html.='<table border="1" cellpadding="3" cellspacing="0">
                    <thead>
                        <tr style="background-color:#DCDCDC;text-align:center;">';
        if ($idrh != ""):
            $html .= '<td style="height: 30px;"><b>Matricule</b></td>';
        endif;
        if ($cin != ""):
            $html .= ' <td><b>C.I.N</b></td>';
        endif;
        if ($nom != ""):
            $html .='   <td><b>Nom</b></td>';
        endif;
        if ($prenom != ""):
            $html .= '<td><b>Prénom</b></td>';
        endif;
        if ($daten != ""):
            $html .='<td><b>Date Naissance</b></td>';
        endif;
        if ($age != ""):
            $html .='<td><b>Age</b></td>';
        endif;
        if ($lieun != ""):
            $html .='<td><b>Lieu Naissance</b></td>';
        endif;
        if ($sexe != ""):
            $html .='<td><b>Sexe</b></td>';
        endif;
        if ($adresse != ""):
            $html .='<td><b>Adresse</b></td>';
        endif;
        if ($reg != ""):
            $html .='<td><b>Regroupement</b></td>';
        endif;
        if ($ville != ""):
            $html .='<td><b>Ville</b></td>';
        endif;
        if ($situation != ""):
            $html .='<td><b>Situation Familiale</b></td>';
        endif;
        if ($idcarte != ""):
            $html .=' <td><b>I. Carte Pro.</b></td>';
        endif;
        if ($etat != ""):
            $html .=' <td><b>Etat militaire</b></td>';
        endif;
        if ($codep != ""):
            $html .='<td><b>Code Postal</b></td>';
        endif;
        if ($paye != ""):
            $html .='  <td><b>Pays</b></td>';
        endif;
        if ($gsm != ""):
            $html .=' <td><b>GSM</b></td>';
        endif;
        if ($idcnss != ""):
            $html .='<td><b>I. unique (CNRPS)</b></td>';
        endif;
        if ($dateaff != ""):
            $html .='<td><b>Date d\'affiliation</b></td>';
        endif;
        if ($rib != ""):
            $html .='<td><b>RIP/B</b></td>';
        endif;
        if ($niveauscolaire != ""):
            $html .='<td><b>Niveau Scolaire</b></td>';
        endif;
        if ($chef != ""):
            $html .='<td><b>Chef Famille</b></td>';
        endif;
        if ($nbrenfant != ""):
            $html .='<td><b>Nombres d\'enfants</b></td>';
        endif;
        $html.='</tr>
                    </thead>
                    <tbody>';

        if ($liste->count() != 0):
            foreach ($liste as $agent):
                $date_naissance = '';
                if ($agent->getDatenaissance())
                    $date_naissance = date('d/m/Y', strtotime($agent->getDatenaissance()));

                $date_affiliation = '';
                if ($agent->getDateaffiliation())
                    $date_affiliation = date('d/m/Y', strtotime($agent->getDateaffiliation()));

                $html.='<tr>';
                if ($idrh != ""):
                    $html .= '<td style="text-align:center;">' . $agent->getIdrh() . '</td>';
                endif;
                if ($cin != ""):
                    $html .= '<td style="text-align:center;">' . $agent->getCin() . '</td>';
                endif;
                if ($nom != ""):
                    $html .='<td>' . $agent->getNomcomplet() . '</td>';
                endif;
                if ($prenom != ""):
                    $html .= '<td>' . $agent->getPrenom() . '</td>';
                endif;
                if ($daten != ""):
                    $html .='<td style="text-align:center;">' . $date_naissance . '</td>';
                endif;
                if ($age != ""):
                    $html .='<td style="text-align:center;">' . $agent->getAge() . '</td>';
                endif;
                if ($lieun != ""):
                    $html .='<td>' . $agent->getGouvernera_10() . '</td>';
                endif;
                if ($sexe != ""):
                    $html .='<td style="text-align:center;">' . $agent->getSexe() . '</td>';
                endif;
                if ($adresse != ""):
                    $html .='<td>' . $agent->getAdresse() . '</td>';
                endif;
                if ($reg != ""):
                    $html .='<td style="text-align:center;">' . $agent->getRegroupementagents() . '</td>';
                endif;
                if ($ville != ""):
                    $html .='<td>' . $agent->getGouvernera() . '</td>';
                endif;
                if ($situation != ""):
                    $html .='<td style="text-align:center;">' . $agent->getEtatcivil() . '</td>';
                endif;
                if ($idcarte != ""):
                    $html .='<td>' . $agent->getIdpersonnel() . '</td>';
                endif;
                if ($etat != ""):
                    $html .='<td style="text-align:center;">' . $agent->getEtatmulitaire() . '</td>';
                endif;
                if ($codep != ""):
                    $html .='<td style="text-align:center;">' . $agent->getCodepostal() . '</td>';
                endif;
                if ($paye != ""):
                    $html .='<td style="text-align:center;">' . $agent->getPays() . '</td>';
                endif;
                if ($gsm != ""):
                    $html .='<td style="text-align:center;">' . $agent->getGsm() . '</td>';
                endif;
                if ($idcnss != ""):
                    $html .='<td style="text-align:center;">' . $agent->getIdcnss() . '</td>';
                endif;
                if ($dateaff != ""):
                    $html .='<td style="text-align:center;">' . $date_affiliation . '</td>';
                endif;
                if ($rib != ""):
                    $html .='<td style="text-align:center;">' . $agent->getRib() . '</td>';
                endif;
                if ($niveauscolaire != ""):
                    $html .='<td>' . $agent->getNiveaueducatif() . '</td>';
                endif;
                if ($chef != ""):
                    $html .='<td>' . $agent->getCheffamille() . '</td>';
                endif;
                if ($nbrenfant != ""):
                    $html .='<td style="text-align:center;">' . $agent->getNbrenfants() . '</td>';
                endif;
                $html.='</tr>';

            endforeach;

        else:
            $html.='<tr><td style="font-size:14px;text-align:center;height:60px;width:100%;">&nbsp;<br><b>Liste vide</b></td></tr>';
        endif;
        $html.='</tbody>
                </table>';

        return $html;
    }

    public function ReadHtmlListePersonnelDonneesBase(sfWebRequest $request) {
        $matricule = strtoupper($request->getParameter('matricule', ''));
        $cin = $request->getParameter('cin', '');
        $nom = strtoupper($request->getParameter('nom', ''));
        $prenom = $request->getParameter('prenom', '');
        $date_naissance = $request->getParameter('date_naissance', '');
        $lieu_naissance = $request->getParameter('lieu_naissance', '');
        $sexe = $request->getParameter('sexe', '');
        $regroupement = $request->getParameter('regroupement', '');
        $adresse = $request->getParameter('adresse', '');
        $situation = $request->getParameter('situation', '');

        $check_value = $request->getParameter('check_value');
        $check_value = explode(',', $check_value);

        $liste = AgentsTable::getInstance()->loadDonneesBase($matricule, $cin, $nom, $prenom, $date_naissance, $lieu_naissance, $sexe, $regroupement, $adresse, $situation)->execute();

        if ($regroupement != '' && $regroupement != '0' && $regroupement != 'null')
            $regroupement_text = RegroupementagentsTable::getInstance()->find($id_regroupement);
        else
            $regroupement_text = 'Tous';

        if ($lieu_naissance != '' && $lieu_naissance != '0' && $lieu_naissance != 'null')
            $lieu_naissance_text = GouverneraTable::getInstance()->find($lieu_naissance)->getGouvernera();
        else
            $lieu_naissance_text = 'Tous';

        if ($sexe != '' && $sexe != '0' && $sexe != 'null')
            $sexe_text = SexeTable::getInstance()->find($sexe);
        else
            $sexe_text = 'Tous';

        if ($situation != '' && $situation != '0' && $situation != 'null')
            $situation_text = EtatcivilTable::getInstance()->find($situation);
        else
            $situation_text = 'Tous';

        if ($date_naissance != '')
            $date_naissance = date('d/m/Y', strtotime($date_naissance));

        $width_rest = 0;
        $width_total = 0;
        $count_showing = 0;
        $width_column = array('0' => '8', '1' => '8', '2' => '12', '3' => '12', '4' => '9', '5' => '11', '6' => '8', '7' => '8', '8' => '14', '9' => '10');
        for ($k = 0; $k < sizeof($check_value); $k++):
            $width_total = $width_total + ($width_column[$k] * $check_value[$k]);
            $count_showing = $count_showing + $check_value[$k];
        endfor;
        $width_rest = 100 - $width_total;

        $for_reste = 0;
        if ($check_value[2] == 1)
            $width_column[2] = $width_column[2] + ($width_rest / 3);
        else
            $for_reste = ($width_rest / 3);
        if ($check_value[3] == 1)
            $width_column[3] = $width_column[3] + ($width_rest / 3);
        else
            $for_reste = $for_reste + ($width_rest / 3);
        if ($check_value[8] == 1)
            $width_column[8] = $width_column[8] + ($width_rest / 3);
        else
            $for_reste = $for_reste + ($width_rest / 3);

        for ($k = 0; $k < sizeof($width_column); $k++):
            $width_column[$k] = $width_column[$k] + $for_reste / $count_showing;
        endfor;

        $html = '<h3 style="font-size:18px;">Liste des Personnels</h3>
            <h5 style="font-size:4px;">&nbsp;</h5>
            &nbsp;<br>';

        $html.='<table border="1" cellpadding="3" cellspacing="0">
                    <thead>
                        <tr style="background-color:#DCDCDC;text-align:center;">';
        if ($check_value[0] == 1):
            $html .= '<td style="height:30px;width:' . $width_column[0] . '%;"><b>Matricule</b></td>';
        endif;
        if ($check_value[1] == 1):
            $html .= '<td style="height:30px;width:' . $width_column[1] . '%;"><b>C.I.N</b></td>';
        endif;
        if ($check_value[2] == 1):
            $html .='<td style="height:30px;width:' . $width_column[2] . '%;"><b>Nom</b></td>';
        endif;
        if ($check_value[3] == 1):
            $html .= '<td style="height:30px;width:' . $width_column[3] . '%;"><b>Prénom</b></td>';
        endif;
        if ($check_value[4] == 1):
            $html .='<td style="height:30px;width:' . $width_column[4] . '%;"><b>Date Naissance (Age)</b></td>';
        endif;
        if ($check_value[5] == 1):
            $html .='<td style="height:30px;width:' . $width_column[5] . '%;"><b>Lieu Naissance</b></td>';
        endif;
        if ($check_value[6] == 1):
            $html .='<td style="height:30px;width:' . $width_column[6] . '%;"><b>Sexe</b></td>';
        endif;
        if ($check_value[7] == 1):
            $html .='<td style="height:30px;width:' . $width_column[7] . '%;"><b>Regroupement</b></td>';
        endif;
        if ($check_value[8] == 1):
            $html .='<td style="height:30px;width:' . $width_column[8] . '%;"><b>Adresse</b></td>';
        endif;
        if ($check_value[9] == 1):
            $html .='<td style="height:30px;width:' . $width_column[9] . '%;"><b>Situation Familiale</b></td>';
        endif;
        $html.='</tr>
                    </thead>
                    <tbody>';

        if ($liste->count() != 0):
            foreach ($liste as $agent):
                $date_naissance_agent = '';
                if ($agent->getDatenaissance())
                    $date_naissance_agent = date('d/m/Y', strtotime($agent->getDatenaissance())) . ' (' . $agent->getAge() . ')';

                $adresse_agent = '';
                if ($agent->getAdresse() != null && trim($agent->getAdresse()) != ''):
                    $adresse_agent = $agent->getAdresse();
                endif;

                if ($agent->getIdGouvn() != null):
                    if ($adresse_agent != '')
                        $adresse_agent = $adresse_agent . ' / ' . $agent->getGouvernera();
                    else
                        $adresse_agent = $agent->getGouvernera();
                endif;

                $html.='<tr>';
                if ($check_value[0] == 1):
                    $html .= '<td style="height:25px;text-align:center;width:' . $width_column[0] . '%;">' . $agent->getIdrh() . '</td>';
                endif;
                if ($check_value[1] == 1):
                    $html .= '<td style="height:25px;text-align:center;width:' . $width_column[1] . '%;">' . $agent->getCin() . '</td>';
                endif;
                if ($check_value[2] == 1):
                    $html .='<td style="height:25px;width:' . $width_column[2] . '%;">' . $agent->getNomcomplet() . '</td>';
                endif;
                if ($check_value[3] == 1):
                    $html .= '<td style="height:25px;width:' . $width_column[3] . '%;">' . $agent->getPrenom() . '</td>';
                endif;
                if ($check_value[4] == 1):
                    $html .='<td style="height:25px;text-align:center;width:' . $width_column[4] . '%;">' . $date_naissance_agent . '</td>';
                endif;
                if ($check_value[5] == 1):
                    $html .='<td style="height:25px;width:' . $width_column[5] . '%;">' . $agent->getGouvernera_10() . '</td>';
                endif;
                if ($check_value[6] == 1):
                    $html .='<td style="height:25px;text-align:center;width:' . $width_column[6] . '%;">' . $agent->getSexe() . '</td>';
                endif;
                if ($check_value[7] == 1):
                    $html .='<td style="height:25px;text-align:center;width:' . $width_column[7] . '%;">' . $agent->getRegroupementagents() . '</td>';
                endif;
                if ($check_value[8] == 1):
                    $html .='<td style="height:25px;width:' . $width_column[8] . '%;">' . $adresse_agent . '</td>';
                endif;
                if ($check_value[9] == 1):
                    $html .='<td style="height:25px;text-align:center;width:' . $width_column[9] . '%;">' . $agent->getEtatcivil() . '</td>';
                endif;
                $html.='</tr>';

            endforeach;

        else:
            $html.='<tr><td style="font-size:14px;text-align:center;height:60px;width:100%;">&nbsp;<br><b>Liste vide</b></td></tr>';
        endif;
        $html.='</tbody>
                </table>';

        return $html;
    }

}
