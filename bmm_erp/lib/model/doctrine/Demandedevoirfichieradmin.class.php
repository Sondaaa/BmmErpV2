<?php

/**
 * Demandedevoirfichieradmin
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    PhpProjectTest
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Demandedevoirfichieradmin extends BaseDemandedevoirfichieradmin {

    public function ReadHtmlDemande() {

        $html = '<div class="titre" style="text-align:center;font-size:22px;width:100%;">'
                . ' طلب الإطلاع على ملف إداري' .
                '</div>&nbsp;<br>&nbsp;<br>';

        $html.='<table>
                <tr><td style="width:160px;text-align:right;font-size:14px;">قبلي، في : ' . date('d/m/Y') . '</td></tr>
                </table>&nbsp;<br>&nbsp;<br>&nbsp;<br>';

        $html.='<table style="width:100%;text-align:right;">
                    <tr>
                        <td style="height:30px;width:85%;font-weight:bold;">' . $this->getServicerh()->getLibelle() . '</td>
                        <td style="width:15%;font-weight:bold;">المصلحـة :</td>
                    </tr>
                    <tr>
                        <td style="height:30px;width:85%;font-weight:bold;">' . $this->getAgents()->getNomcomplet() . ' ' . $this->getAgents()->getPrenom() . '</td>
                        <td style="width:15%;font-weight:bold;">إسم الطالب :</td>
                    </tr>
                </table>&nbsp;<br>&nbsp;<br>';

        $person = Doctrine_Core::getTable('agents')->findOneById($this->getIdAgents());
        $html.='<table style="width:100%;text-align:right;">
                    <tr>
                        <td style="height:30px; width:78%;">' . $person->getNomcomplet() . '</td>
                        <td style="width:22%;font-weight:bold;">الملف الإداري للعون :</td>
                    </tr>
                    <tr>
                        <td style="height:30px; width:83%;">' . $person->getIdrh() . '</td>
                        <td style="width:17%;font-weight:bold;">الرقم بالديوان  :</td>
                    </tr>
                    <tr>
                        <td style="height:30px; width:71%;">' . $this->getDocument() . '</td>
                        <td style="width:29%;font-weight:bold;">الوثائق المراد الإطلاع عليها :</td>
                    </tr>
                    <tr>
                        <td style="height:30px; width:84%;">' . date('d/m/Y', strtotime($this->getDatedevue())) . '</td>
                        <td style="width:16%;font-weight:bold;">تاريخ الإطلاع :</td>
                    </tr>
                </table>&nbsp;<br>&nbsp;<br>';

        $html.='<table style="width:100%;text-align:right;">
                    <tr>
                        <td style="height:30px; width:78%;"></td>
                        <td style="width:22%;font-weight:bold;">النسخ المتحصل عليها</td>
                    </tr>
                </table>&nbsp;<br>&nbsp;<br>';

        $html.= '<table border="1" style="width:100%;text-align:center;">
                    <tr style="font-weight:bold;">
                        <th style="width: 60%; height:30px; font-size:12px;">المحتوى</th>
                        <th style="width: 20%; font-size:12px;">نوعية الوثيقة</th>
                        <th style="width: 15%; font-size:12px;">رقم التسجيل</th>
                        <th style="width: 5%; font-size:12px;">رقم</th>
                    </tr>';

        $lignecopie = Doctrine_Core::getTable('lignedemandecopie')->findByIdDemande($this->getId());
        foreach ($lignecopie as $copi):
            $html.= '<tr style="font-weight:bold;">
                        <th style="width: 60%; height:30px; font-size:12px;">' . $copi->getContenu() . '</th>
                        <th style="width: 20%; font-size:12px;">' . $copi->getType() . '</th>
                        <th style="width: 15%; font-size:12px;">' . $copi->getNumero() . '</th>
                        <th style="width: 5%; font-size:12px;">' . $copi->getNorde() . '</th>
                    </tr>';
        endforeach;


        for ($i = $lignecopie->count() + 1; $i < 7; $i++)
            $html.= '<tr>
                        <td style="height:25px;">............................................</td>
                        <td>............................</td>
                        <td>...................</td>
                        <td>' . $i . '</td>
                    </tr>';

        $html.='</table>&nbsp;<br>&nbsp;<br>';

        $html.='<table style="width:100%;text-align:center;">
                    <tr>
                        <td style="height:140px; width:50%;">رئيس مصلحة التصرف في الموارد البشرية<br>' . $this->getSignaturedirecteur() . '</td>
                        <td style="width:20%;"></td>
                        <td style="width:30%;">إمضاء الطالب<br>' . $this->getSignatureagents() . '</td>
                    </tr>
                </table>';

        return $html;
    }

}
