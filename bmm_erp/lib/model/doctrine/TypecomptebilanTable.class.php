<?php

/**
 * TypecomptebilanTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TypecomptebilanTable extends Doctrine_Table {

    /**
     * Returns an instance of this class.
     *
     * @return object TypecomptebilanTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('Typecomptebilan');
    }

    public function loadAll($id_exercice, $compte = '', $type = '') {
        $q = $this->createQuery('b')
                ->leftJoin('b.Plancomptable p')
                ->leftJoin('b.Typecompte t')
                ->where('b.id_exercice = ?', $id_exercice)
                ->andWhere('b.id_dossier = ?', $_SESSION['dossier_id']);
        if ($compte != '') {
            $q->andWhere("(p.numerocompte LIKE '%" . $compte . "%' Or p.libelle LIKE '%" . $compte . "%')");
        }
        if ($type != '') {
            $q->andWhere('t.libelle LIKE "%' . $type . '%"');
        }
        $q->orderBy('p.numerocompte');
        return $q;
    }

}
