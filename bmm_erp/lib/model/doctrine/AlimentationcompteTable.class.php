<?php

/**
 * AlimentationcompteTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class AlimentationcompteTable extends Doctrine_Table {

    /**
     * Returns an instance of this class.
     *
     * @return object AlimentationcompteTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('Alimentationcompte');
    }

    public function getListeByTitre($id, $montant) {
        $query = $this->createQuery('a')
                ->leftJoin('a.Caissesbanques c')
                ->leftJoin('c.Lignebanquecaisse l')
                ->leftJoin('l.Ligprotitrub lig')
                ->where('lig.id_titre = ?', $id)
                ->andWhere('a.montant <= ?', $montant)
                ->orderBy('a.date');
        return $query->execute();
    }

    public function getListeByTitreForValide($id, $montant) {
        $query = $this->createQuery('a')
                ->leftJoin('a.Caissesbanques c')
                ->leftJoin('c.Lignebanquecaisse l')
                ->leftJoin('l.Ligprotitrub lig')
                ->where('lig.id_titre = ?', $id)
                ->andWhere('a.montant <= ?', $montant)
                ->andWhere('a.id_tranchebudget IS NULL')
                ->orderBy('a.date');
        return $query->execute();
    }

}
