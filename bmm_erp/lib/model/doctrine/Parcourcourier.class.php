<?php

/**
 * Parcourcourier
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    Bmm
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Parcourcourier extends BaseParcourcourier {

    public function __toString() {
        return "" . $this->getCourrier();
    }

    public function getRecepteur() {
        if ($this->getIdRec()) {
            $rec = Doctrine_Core::getTable('expdest')->findOneById($this->getIdRec());
            if ($rec)
                return $rec;
            else
                return null;
        }
        return null;
    }

    public function getReponsetext() {
        return $this->getCourrier()->getDatemaxdereponse();
    }

    public function getCourriersource() {
        return $this->getCourrier()->getCourriersource();
    }

    public function getDatecreationetdatemax() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());
        if ($this->getMdreponse() != '')
            $date_m_reponse = date('d/m/Y', strtotime($this->getMdreponse()));
        else
            $date_m_reponse = '';

        $stingtable = "<table>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Date Création"
                . "</td>"
                . "<td>" . date('d/m/Y', strtotime($courrier->getDatecreation()))
                . "</td>"
                . "</tr>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Date M.Réponse"
                . "</td>"
                . "<td>" . $date_m_reponse
                . "</td>"
                . "</tr>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Utilisateur"
                . "</td>"
                . "<td>" . $courrier->getUtilisateur()
                . "</td>"
                . "</tr>"
                . "</table>";
        echo $stingtable;
    }

    public function getExpdestinataire() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());
        $recepteur = '';
        if ($courrier->getIdUser() != null)
            $recepteur = $this->getRecepteur();
        else
            $recepteur = $courrier->getFamexpdes();
        $stingtable = "<table >"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Expéditeur"
                . "</td>"
                . "<td>" . $this->getExpdest() . "</td>"
                . "</tr>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td colspan='2'>====>" . $this->getActionparcour()
                . "</td>"
                . "</tr>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Récepteur"
                . "</td>"
                . "<td>" . $recepteur . "</td>"
                . "</tr>"
                . "</table>";
        echo $stingtable;
    }

    public function getCourrieretcourriersource() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());

        $stingtable = "<table>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Courrier"
                . "</td>"
                . "<td>" . $courrier . "<br>" . $courrier->getDatemaxdereponse()
                . "</td>"
                . "</tr>"
                . "<tr style='" . $courrier->getTypecourrier()->getCoul() . "'>"
                . "<td>Source"
                . "</td>"
                . "<td>" . $courrier->getCourriersource()
                . "</td>"
                . "</tr>"
                . "</table>";
        echo $stingtable;
    }

    public function getDatecreationetdatemax1() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());
        if ($this->getMdreponse() != '')
            $date_m_reponse = date('d/m/Y', strtotime($this->getMdreponse()));
        else
            $date_m_reponse = '';
        $stingtable = '<table cellpadding="3">
                            <tr><td>D.Création<br>' . date('d/m/Y', strtotime($courrier->getDatecreation())) . '</td></tr>
                            <tr><td>D.M.Réponse<br>' . $date_m_reponse . '</td></tr>
                            <tr><td>Utilisateur<br>' . $courrier->getUtilisateur() . '</td></tr>
                        </table>';
        return $stingtable;
    }

    public function getExpdestinataire1() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());
        $recepteur = '';
        if($this->getRecepteur())
            $recepteur = $this->getRecepteur()->getRtl();
        $stingtable = '<table cellpadding="3">
                            <tr style="' . $courrier->getTypecourrier()->getCoul() . '">
                                <td>Expéditeur<br>' . $this->getExpdest()->getRtl() . '</td>
                            </tr>
                            <tr><td colspan="2">====>' . $this->getActionparcour() . '</td></tr>
                            <tr><td>Destinataire<br>' . $recepteur . '</td></tr>
                        </table>';
        return $stingtable;
    }

    public function getCourrieretcourriersource1() {
        $courrier = Doctrine_Core::getTable('courrier')->findOneById($this->getIdCourrierdest());
        if ($courrier->getDatemaxdereponse1() != '')
            $date_m_reponse = "<br>" . date('d/m/Y', strtotime($courrier->getDatemaxdereponse1()));
        else
            $date_m_reponse = '';
        $stingtable = '<table cellpadding="3">
                            <tr><td>Courrier<br>' . $courrier . $date_m_reponse . '</td></tr>
                            <tr><td>Source<br>' . $courrier->getCourriersource() . '</td></tr>
                        </table>';
        return $stingtable;
    }

}
